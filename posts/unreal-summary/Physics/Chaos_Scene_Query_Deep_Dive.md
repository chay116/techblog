---
title: "Chaos Scene Query Deep Dive"
date: "2025-12-09"
status: "stable"
project: "UnrealEngine"
lang: "ko"
category: "unreal-summary"
track: "Physics"
tags: ["unreal", "Physics"]
engine_version: "** Unreal Engine 5.7"
---
# Chaos Scene Query Deep Dive

## ğŸ§­ ê°œìš”

**Scene Query**ëŠ” ë¬¼ë¦¬ ì›”ë“œì—ì„œ ê¸°í•˜í•™ì  ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. Raycast, Sweep, Overlap ë“±ì„ í†µí•´ ì¶©ëŒ ê°ì§€, ì‹œì„  ê²€ì‚¬, íŠ¸ë¦¬ê±° ì˜ì—­ í™•ì¸ ë“±ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

### í•µì‹¬ ê°œë…

| ê°œë… | ì„¤ëª… |
|------|------|
| **Raycast** | ë ˆì´(ì„ ë¶„)ì™€ ë¬¼ì²´ ì¶©ëŒ ê²€ì‚¬ |
| **Sweep** | í˜•ìƒì„ ì´ë™ì‹œí‚¤ë©° ì¶©ëŒ ê²€ì‚¬ |
| **Overlap** | íŠ¹ì • ì˜ì—­ ë‚´ ë¬¼ì²´ ê²€ì¶œ |
| **Filter** | ì¿¼ë¦¬ ëŒ€ìƒ í•„í„°ë§ |
| **Hit Result** | ì¶©ëŒ ê²°ê³¼ ì •ë³´ |

---

## ğŸ§± ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Scene Query Architecture                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  UWorld::LineTraceSingleByChannel()
         â”‚
         â†“
  FPhysicsInterface::RaycastSingle()
         â”‚
         â†“
  FPhysScene_Chaos
         â”‚
         â”œâ”€â”€ FSQAccelerator (ê°€ì† êµ¬ì¡°)
         â”‚        â”‚
         â”‚        â”œâ”€â”€ AABB Tree (ê³µê°„ ë¶„í• )
         â”‚        â”‚
         â”‚        â””â”€â”€ Broadphase ìµœì í™”
         â”‚
         â†“
  TSQVisitor<HitType>
         â”‚
         â”œâ”€â”€ PreFilter (ì‚¬ì „ í•„í„°ë§)
         â”‚        â”‚
         â”‚        â””â”€â”€ FCollisionQueryParams
         â”‚
         â”œâ”€â”€ Narrowphase (ì •ë°€ ê²€ì‚¬)
         â”‚        â”‚
         â”‚        â”œâ”€â”€ GJK/EPA Algorithm
         â”‚        â”‚
         â”‚        â””â”€â”€ SAT (Separating Axis Theorem)
         â”‚
         â””â”€â”€ PostFilter (í›„ì²˜ë¦¬)
                  â”‚
                  â””â”€â”€ FHitResult ìƒì„±

```

---

## ğŸ“‚ ì£¼ìš” ì†ŒìŠ¤ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| `PhysicsCore/Public/SQAccelerator.h` | Scene Query ê°€ì†ê¸° |
| `PhysicsCore/Public/SQVisitor.h` | ì¿¼ë¦¬ ë°©ë¬¸ì íŒ¨í„´ |
| `Chaos/Public/Chaos/ParticleHandle.h` | íŒŒí‹°í´ í•¸ë“¤ |
| `Engine/Public/CollisionQueryParams.h` | ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° |
| `Engine/Public/Engine/HitResult.h` | íˆíŠ¸ ê²°ê³¼ êµ¬ì¡°ì²´ |

---

## ğŸ”· Query Types

### 1. Raycast (ë ˆì´ìºìŠ¤íŠ¸)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Raycast Types                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  1. Single Raycast (ì²« ë²ˆì§¸ ì¶©ëŒë§Œ)                                             â”‚
â”‚                                                                                  â”‚
â”‚       Start â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ End                   â”‚
â”‚                              Hit Point                                          â”‚
â”‚                                                                                  â”‚
â”‚     í•¨ìˆ˜: LineTraceSingleByChannel()                                            â”‚
â”‚     ê²°ê³¼: bool + FHitResult                                                     â”‚
â”‚                                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                                  â”‚
â”‚  2. Multi Raycast (ëª¨ë“  ì¶©ëŒ)                                                   â”‚
â”‚                                                                                  â”‚
â”‚       Start â—â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â†’ End                      â”‚
â”‚                  Hit1       Hit2           Hit3                                 â”‚
â”‚                                                                                  â”‚
â”‚     í•¨ìˆ˜: LineTraceMultiByChannel()                                             â”‚
â”‚     ê²°ê³¼: bool + TArray<FHitResult>                                             â”‚
â”‚                                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                                  â”‚
â”‚  3. Test Raycast (ì¶©ëŒ ì—¬ë¶€ë§Œ)                                                  â”‚
â”‚                                                                                  â”‚
â”‚       Start â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ End                    â”‚
â”‚                              blocked?                                           â”‚
â”‚                                                                                  â”‚
â”‚     í•¨ìˆ˜: LineTraceTestByChannel()                                              â”‚
â”‚     ê²°ê³¼: bool (ì¶©ëŒ ì—¬ë¶€ë§Œ)                                                    â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Sweep (ìŠ¤ìœ•)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               Sweep Types                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  Sphere Sweep:                                                                   â”‚
â”‚                                                                                  â”‚
â”‚      ( â— )â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€( â— )â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’                           â”‚
â”‚       Start                 Hit                                                  â”‚
â”‚                                                                                  â”‚
â”‚  Box Sweep:                                                                      â”‚
â”‚                                                                                  â”‚
â”‚      â”Œâ”€â”€â”€â”                  â”Œâ”€â”€â”€â”                                               â”‚
â”‚      â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’                           â”‚
â”‚      â””â”€â”€â”€â”˜                  â””â”€â”€â”€â”˜                                               â”‚
â”‚       Start                 Hit                                                  â”‚
â”‚                                                                                  â”‚
â”‚  Capsule Sweep:                                                                  â”‚
â”‚                                                                                  â”‚
â”‚      (â•â•â•)                  (â•â•â•)                                               â”‚
â”‚      ( â— )â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€( â— )â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’                           â”‚
â”‚      (â•â•â•)                  (â•â•â•)                                               â”‚
â”‚       Start                 Hit                                                  â”‚
â”‚                                                                                  â”‚
â”‚  í•¨ìˆ˜:                                                                          â”‚
â”‚  - SweepSingleByChannel()                                                       â”‚
â”‚  - SweepMultiByChannel()                                                        â”‚
â”‚  - SweepTestByChannel()                                                         â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Overlap (ì˜¤ë²„ë©)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Overlap Types                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  Sphere Overlap:                        Box Overlap:                             â”‚
â”‚                                                                                  â”‚
â”‚       â”Œâ”€â”€â—â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚      /  â—   \                           â”‚  â—      â—   â”‚                         â”‚
â”‚     (   â—    )   â— = ê²€ì¶œëœ ë¬¼ì²´        â”‚      â—      â”‚                         â”‚
â”‚      \  â—   /                           â”‚  â—          â”‚                         â”‚
â”‚       â””â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                                  â”‚
â”‚  í•¨ìˆ˜:                                                                          â”‚
â”‚  - OverlapMultiByChannel() â†’ TArray<FOverlapResult>                             â”‚
â”‚  - OverlapBlockingTestByChannel() â†’ bool                                        â”‚
â”‚  - OverlapAnyTestByChannel() â†’ bool                                             â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¶ Query Parameters

### FCollisionQueryParams

```cpp
// CollisionQueryParams.h
struct FCollisionQueryParams
{
    // ì¿¼ë¦¬ ì´ë¦„ (ë””ë²„ê¹…ìš©)
    FName TraceTag;

    // ì†Œìœ ì ì´ë¦„ (ë””ë²„ê¹…ìš©)
    FName OwnerTag;

    // ë³µì¡í•œ ì¶©ëŒ ì‚¬ìš© ì—¬ë¶€
    bool bTraceComplex;

    // í˜ì´ìŠ¤ ì¸ë±ìŠ¤ ë°˜í™˜ ì—¬ë¶€
    bool bReturnFaceIndex;

    // ë¬¼ë¦¬ ë¨¸í‹°ë¦¬ì–¼ ë°˜í™˜ ì—¬ë¶€
    bool bReturnPhysicalMaterial;

    // ë¬´ì‹œí•  ì•¡í„° ëª©ë¡
    TArray<AActor*> IgnoredActors;

    // ë¬´ì‹œí•  ì»´í¬ë„ŒíŠ¸ ëª©ë¡
    TArray<UPrimitiveComponent*> IgnoredComponents;

    // ì´ˆê¸° ì˜¤ë²„ë© ë¬´ì‹œ
    bool bIgnoreTouches;

    // ì²« ë²ˆì§¸ ë¸”ë¡œí‚¹ë§Œ ë°˜í™˜
    bool bFindInitialOverlaps;

    // ì •ì  ë©”ì„œë“œ
    static FCollisionQueryParams DefaultQueryParam;
};
```

### FCollisionResponseParams

```cpp
// ì¶©ëŒ ì‘ë‹µ ì„¤ì •
struct FCollisionResponseParams
{
    FCollisionResponseContainer CollisionResponse;

    static FCollisionResponseParams DefaultResponseParam;
};
```

### FCollisionObjectQueryParams

```cpp
// ì˜¤ë¸Œì íŠ¸ íƒ€ì… í•„í„°
struct FCollisionObjectQueryParams
{
    // ì¿¼ë¦¬í•  ì˜¤ë¸Œì íŠ¸ íƒ€ì… ë§ˆìŠ¤í¬
    int32 ObjectTypesToQuery;

    // í—¬í¼ ìƒì„±ì
    FCollisionObjectQueryParams(ECollisionChannel Channel);
    FCollisionObjectQueryParams(const TArray<TEnumAsByte<EObjectTypeQuery>>& ObjectTypes);

    // ëª¨ë“  ë™ì  ì˜¤ë¸Œì íŠ¸
    static FCollisionObjectQueryParams AllDynamicObjects;

    // ëª¨ë“  ì •ì  ì˜¤ë¸Œì íŠ¸
    static FCollisionObjectQueryParams AllStaticObjects;

    // ëª¨ë“  ì˜¤ë¸Œì íŠ¸
    static FCollisionObjectQueryParams AllObjects;
};
```

---

## ğŸ”· Hit Result

### FHitResult êµ¬ì¡°ì²´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FHitResult Structure                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  Blocking Info:                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  bBlockingHit    : bool        // ë¸”ë¡œí‚¹ ì¶©ëŒ ì—¬ë¶€                      â”‚   â”‚
â”‚  â”‚  bStartPenetrating : bool      // ì‹œì‘ë¶€í„° ê²¹ì¹¨                         â”‚   â”‚
â”‚  â”‚  FaceIndex       : int32       // ì¶©ëŒ í˜ì´ìŠ¤ ì¸ë±ìŠ¤                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚  Position Info:                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Time            : float       // ì¶©ëŒ ì‹œê°„ (0-1)                       â”‚   â”‚
â”‚  â”‚  Distance        : float       // ì¶©ëŒ ê±°ë¦¬                             â”‚   â”‚
â”‚  â”‚  Location        : FVector     // ì¶©ëŒ ìœ„ì¹˜ (ì›”ë“œ ì¢Œí‘œ)                 â”‚   â”‚
â”‚  â”‚  ImpactPoint     : FVector     // ì‹¤ì œ ì¶©ëŒ ì§€ì                         â”‚   â”‚
â”‚  â”‚  Normal          : FVector     // íŠ¸ë ˆì´ìŠ¤ ë°©í–¥ì˜ ë…¸ë©€                  â”‚   â”‚
â”‚  â”‚  ImpactNormal    : FVector     // ì¶©ëŒ í‘œë©´ ë…¸ë©€                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚  Component Info:                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  PhysMaterial    : UPhysicalMaterial*   // ë¬¼ë¦¬ ë¨¸í‹°ë¦¬ì–¼                â”‚   â”‚
â”‚  â”‚  Actor           : TWeakObjectPtr<AActor>                                â”‚   â”‚
â”‚  â”‚  Component       : TWeakObjectPtr<UPrimitiveComponent>                   â”‚   â”‚
â”‚  â”‚  BoneName        : FName       // ìŠ¤ì¼ˆë ˆíƒˆ ë©”ì‹œ ë³¸ ì´ë¦„                 â”‚   â”‚
â”‚  â”‚  Item            : int32       // ë³µí•© ì¶©ëŒì²´ ì¸ë±ìŠ¤                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚  Trace Info:                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TraceStart      : FVector     // íŠ¸ë ˆì´ìŠ¤ ì‹œì‘ì                        â”‚   â”‚
â”‚  â”‚  TraceEnd        : FVector     // íŠ¸ë ˆì´ìŠ¤ ì¢…ë£Œì                        â”‚   â”‚
â”‚  â”‚  PenetrationDepth : float      // ì¹¨íˆ¬ ê¹Šì´                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¶ Collision Channels

### ê¸°ë³¸ ì±„ë„

```cpp
// ECollisionChannel
enum ECollisionChannel
{
    ECC_WorldStatic,      // ì •ì  ì›”ë“œ ì§€ì˜¤ë©”íŠ¸ë¦¬
    ECC_WorldDynamic,     // ë™ì  ì•¡í„°
    ECC_Pawn,             // í”Œë ˆì´ì–´/AI
    ECC_Visibility,       // ì‹œì„  íŠ¸ë ˆì´ìŠ¤ ì „ìš©
    ECC_Camera,           // ì¹´ë©”ë¼ ì¶©ëŒ
    ECC_PhysicsBody,      // ë¬¼ë¦¬ ë°”ë””
    ECC_Vehicle,          // ì°¨ëŸ‰
    ECC_Destructible,     // íŒŒê´´ ê°€ëŠ¥ ì˜¤ë¸Œì íŠ¸

    // ì»¤ìŠ¤í…€ ì±„ë„ (í”„ë¡œì íŠ¸ ì„¤ì •)
    ECC_GameTraceChannel1,
    ECC_GameTraceChannel2,
    // ... ECC_GameTraceChannel18
};
```

### Collision Response

```cpp
// ECollisionResponse
enum ECollisionResponse
{
    ECR_Ignore,     // ë¬´ì‹œ (ì¶©ëŒ ì—†ìŒ)
    ECR_Overlap,    // ì˜¤ë²„ë© (ì´ë²¤íŠ¸ë§Œ)
    ECR_Block       // ë¸”ë¡ (ë¬¼ë¦¬ì  ì¶©ëŒ)
};
```

---

## ğŸ”· Scene Query Accelerator

### FSQAccelerator êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           FSQAccelerator (Scene Query)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  ê³µê°„ ê°€ì† êµ¬ì¡°:                                                                 â”‚
â”‚                                                                                  â”‚
â”‚     World Space                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                                   â”‚
â”‚    â”‚   â”‚ Cell 0,0 â”‚  â”‚ Cell 1,0 â”‚  ...     â”‚                                   â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                                   â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                                   â”‚
â”‚    â”‚   â”‚ Cell 0,1 â”‚  â”‚ Cell 1,1 â”‚  ...     â”‚                                   â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â† AABB Tree / Grid            â”‚
â”‚    â”‚        ...           ...              â”‚                                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                                                                                  â”‚
â”‚  Broadphase ë‹¨ê³„:                                                               â”‚
â”‚  1. Ray/Shape AABB ê³„ì‚°                                                         â”‚
â”‚  2. ê²¹ì¹˜ëŠ” Cell ì°¾ê¸°                                                            â”‚
â”‚  3. Cell ë‚´ ì˜¤ë¸Œì íŠ¸ ëª©ë¡ ë°˜í™˜                                                  â”‚
â”‚                                                                                  â”‚
â”‚  Narrowphase ë‹¨ê³„:                                                              â”‚
â”‚  1. ê° í›„ë³´ì— ëŒ€í•´ ì •ë°€ ê²€ì‚¬                                                    â”‚
â”‚  2. GJK/EPAë¡œ ì¶©ëŒ ê³„ì‚°                                                         â”‚
â”‚  3. Hit ì •ë³´ ìƒì„±                                                               â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### TSQVisitor

```cpp
// SQVisitor.h
template<typename HitType>
class TSQVisitor
{
public:
    // ì¶©ëŒ ê²€ì‚¬ ì „ í•„í„°
    virtual bool PreFilter(
        const FCollisionFilterData& FilterData,
        const Chaos::FPerShapeData* ShapeData,
        const Chaos::FGeometryParticle* Particle
    ) = 0;

    // ì¶©ëŒ ê²€ì‚¬ í›„ í•„í„°
    virtual bool PostFilter(
        const HitType& Hit,
        const Chaos::FPerShapeData* ShapeData,
        const Chaos::FGeometryParticle* Particle
    ) = 0;

    // ê²°ê³¼ ì €ì¥
    virtual void AddHit(const HitType& Hit) = 0;

    // ê²€ìƒ‰ ê³„ì† ì—¬ë¶€
    virtual bool ShouldContinue() const = 0;
};
```

---

## ğŸ’¡ ì‹¤ì „ ì‚¬ìš© ì˜ˆì‹œ

### 1. ê¸°ë³¸ Raycast

```cpp
// ë‹¨ì¼ ë ˆì´ìºìŠ¤íŠ¸
FHitResult Hit;
FVector Start = GetActorLocation();
FVector End = Start + GetActorForwardVector() * 1000.f;

FCollisionQueryParams QueryParams;
QueryParams.AddIgnoredActor(this);  // ìì‹  ë¬´ì‹œ
QueryParams.bTraceComplex = false;   // ë‹¨ìˆœ ì¶©ëŒ ì‚¬ìš©

if (GetWorld()->LineTraceSingleByChannel(
    Hit,
    Start,
    End,
    ECC_Visibility,
    QueryParams))
{
    // ì¶©ëŒ ë°œìƒ
    AActor* HitActor = Hit.GetActor();
    FVector HitLocation = Hit.ImpactPoint;
    FVector HitNormal = Hit.ImpactNormal;
}
```

### 2. Sphere Sweep

```cpp
// ìºë¦­í„° ì´ë™ ê²½ë¡œ ê²€ì‚¬
FHitResult Hit;
FVector Start = GetActorLocation();
FVector End = Start + MoveDirection * MoveDistance;

FCollisionShape Shape = FCollisionShape::MakeSphere(CapsuleRadius);

if (GetWorld()->SweepSingleByChannel(
    Hit,
    Start,
    End,
    FQuat::Identity,
    ECC_Pawn,
    Shape,
    QueryParams))
{
    // ì¥ì• ë¬¼ê³¼ ì¶©ëŒ
    FVector SafeLocation = Hit.Location;
    float BlockedDistance = Hit.Distance;
}
```

### 3. Overlap Multi

```cpp
// ë²”ìœ„ ë‚´ ëª¨ë“  ì  ê²€ì¶œ
TArray<FOverlapResult> Overlaps;
FVector Center = GetActorLocation();
float Radius = 500.f;

FCollisionShape Shape = FCollisionShape::MakeSphere(Radius);

if (GetWorld()->OverlapMultiByObjectType(
    Overlaps,
    Center,
    FQuat::Identity,
    FCollisionObjectQueryParams(ECC_Pawn),
    Shape,
    QueryParams))
{
    for (const FOverlapResult& Overlap : Overlaps)
    {
        AActor* OverlappedActor = Overlap.GetActor();
        // ì²˜ë¦¬...
    }
}
```

### 4. Async Scene Query

```cpp
// ë¹„ë™ê¸° ë ˆì´ìºìŠ¤íŠ¸ (ë©€í‹°ìŠ¤ë ˆë“œ)
FTraceHandle TraceHandle = GetWorld()->AsyncLineTraceByChannel(
    EAsyncTraceType::Single,
    Start,
    End,
    ECC_Visibility,
    QueryParams,
    FCollisionResponseParams::DefaultResponseParam,
    &AsyncTraceDelegate  // ì™„ë£Œ ì½œë°±
);

// ì½œë°± ë¸ë¦¬ê²Œì´íŠ¸
void OnAsyncTraceComplete(const FTraceHandle& Handle, FTraceDatum& Data)
{
    if (Data.OutHits.Num() > 0)
    {
        FHitResult& Hit = Data.OutHits[0];
        // ì²˜ë¦¬...
    }
}
```

---

## âš™ï¸ ì„±ëŠ¥ ìµœì í™”

### 1. Query ë¹„ìš© ë¹„êµ

| Query Type | ìƒëŒ€ ë¹„ìš© | ì‚¬ìš© ìƒí™© |
|------------|----------|----------|
| LineTraceTest | 1x | ì¶©ëŒ ì—¬ë¶€ë§Œ í•„ìš” |
| LineTraceSingle | 1.2x | ì²« ë²ˆì§¸ ì¶©ëŒ ì •ë³´ í•„ìš” |
| LineTraceMulti | 2-3x | ëª¨ë“  ì¶©ëŒ ì •ë³´ í•„ìš” |
| SweepSingle | 3-5x | í˜•ìƒ ê¸°ë°˜ ì¶©ëŒ ê²€ì‚¬ |
| SweepMulti | 5-10x | í˜•ìƒ ê¸°ë°˜ ëª¨ë“  ì¶©ëŒ |
| OverlapMulti | 2-4x | ì˜ì—­ ë‚´ ì˜¤ë¸Œì íŠ¸ ê²€ì¶œ |

### 2. ìµœì í™” íŒ

```cpp
// âœ… ì¢‹ì€ ì˜ˆ: ê°„ë‹¨í•œ ì¶©ëŒë§Œ ì‚¬ìš©
QueryParams.bTraceComplex = false;

// âœ… ì¢‹ì€ ì˜ˆ: í•„ìš”í•œ ì •ë³´ë§Œ ìš”ì²­
QueryParams.bReturnFaceIndex = false;
QueryParams.bReturnPhysicalMaterial = false;

// âœ… ì¢‹ì€ ì˜ˆ: ë¶ˆí•„ìš”í•œ ì•¡í„° ë¬´ì‹œ
QueryParams.AddIgnoredActors(IgnoreList);

// âŒ ë‚˜ìœ ì˜ˆ: ë§¤ í”„ë ˆì„ ëª¨ë“  ì˜¤ë¸Œì íŠ¸ ê²€ì‚¬
// GetWorld()->LineTraceMulti... (ê³¼ë„í•œ ì‚¬ìš©)

// âœ… ì¢‹ì€ ì˜ˆ: ë¹„ë™ê¸° ì¿¼ë¦¬ë¡œ ë¶€í•˜ ë¶„ì‚°
GetWorld()->AsyncLineTraceByChannel(...);
```

### 3. ê´€ë ¨ CVars

```cpp
// ë””ë²„ê·¸ ì‹œê°í™”
p.Chaos.DebugDraw.SceneQuery = 1

// ì„±ëŠ¥ íŠœë‹
p.Chaos.SceneQuery.CellSize = 100.0        // ê³µê°„ ë¶„í•  ì…€ í¬ê¸°
p.Chaos.SceneQuery.MaxResults = 256        // ìµœëŒ€ ê²°ê³¼ ìˆ˜
```

---

## ğŸ”§ ë””ë²„ê¹…

### ì‹œê°ì  ë””ë²„ê¹…

```cpp
// ë ˆì´ìºìŠ¤íŠ¸ ì‹œê°í™”
DrawDebugLine(
    GetWorld(),
    Start,
    End,
    Hit.bBlockingHit ? FColor::Red : FColor::Green,
    false,
    1.0f
);

// ì¶©ëŒ ì§€ì  ì‹œê°í™”
if (Hit.bBlockingHit)
{
    DrawDebugSphere(
        GetWorld(),
        Hit.ImpactPoint,
        10.f,
        12,
        FColor::Red,
        false,
        1.0f
    );

    DrawDebugDirectionalArrow(
        GetWorld(),
        Hit.ImpactPoint,
        Hit.ImpactPoint + Hit.ImpactNormal * 50.f,
        20.f,
        FColor::Blue,
        false,
        1.0f
    );
}
```

### ì½˜ì†” ëª…ë ¹

```
show Collision          // ì¶©ëŒ ì²´ í‘œì‹œ
p.Chaos.DebugDraw.SceneQuery 1  // ì¿¼ë¦¬ ì‹œê°í™”
stat SceneQuery         // ì¿¼ë¦¬ í†µê³„
```

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [Overview.md](Overview.md) - ë¬¼ë¦¬ ì‹œìŠ¤í…œ ê°œìš”
- [Chaos_Collision_Detection_Deep_Dive.md](Chaos_Collision_Detection_Deep_Dive.md) - ì¶©ëŒ ê°ì§€ ìƒì„¸
- [Collision_And_SceneQuery.md](Collision_And_SceneQuery.md) - ì¶©ëŒ ë° ì¿¼ë¦¬ ê¸°ì´ˆ

---

> ì´ ë¬¸ì„œëŠ” Chaos Physicsì˜ Scene Query ì‹œìŠ¤í…œì„ ì„¤ëª…í•©ë‹ˆë‹¤.