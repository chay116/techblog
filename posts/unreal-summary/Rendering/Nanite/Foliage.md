---
title: "Nanite Foliage ì§€ì› ì‹œìŠ¤í…œ"
date: "2025-11-23"
status: "stable"
project: "UnrealEngine"
lang: "ko"
category: "unreal-summary"
track: "Rendering"
tags: ["unreal", "Rendering", "Nanite"]
---
# Nanite Foliage ì§€ì› ì‹œìŠ¤í…œ

## ğŸ§­ ê°œìš” (Overview)

**Nanite Foliage**ëŠ” Nanite ì§€ì˜¤ë©”íŠ¸ë¦¬ë¥¼ **HierarchicalInstancedStaticMeshComponent (HISM)**ì™€ ê²°í•©í•˜ì—¬ ëŒ€ëŸ‰ì˜ í’€, ë‚˜ë¬´, ê´€ëª© ë“±ì˜ ì‹ë¬¼ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

**í•µì‹¬ ê°œë…:**
- **HISM + Nanite**: ì¼ë°˜ Nanite ë©”ì‹œë¥¼ HISM Componentë¡œ ì¸ìŠ¤í„´ì‹±
- **WPO ì§€ì›**: World Position Offsetì„ í†µí•œ ë°”ëŒ ì• ë‹ˆë©”ì´ì…˜
- **ìë™ LOD**: Naniteì˜ ë™ì  LOD ì‹œìŠ¤í…œ í™œìš©
- **ëŒ€ëŸ‰ ì¸ìŠ¤í„´ì‹±**: ìˆ˜ë§Œ~ìˆ˜ì‹­ë§Œ ê°œì˜ Foliage ì¸ìŠ¤í„´ìŠ¤ ì²˜ë¦¬

**ì¤‘ìš”:** Nanite FoliageëŠ” **ë³„ë„ì˜ ì‹œìŠ¤í…œì´ ì•„ë‹ˆë¼** Naniteì˜ ê¸°ì¡´ ê¸°ëŠ¥(Instancing + WPO)ì„ Foliageì— ì ìš©í•œ ê²ƒì…ë‹ˆë‹¤.

**ğŸ“‚ ì£¼ìš” ì†ŒìŠ¤ ìœ„ì¹˜:**
- `Engine/Source/Runtime/Foliage/Public/FoliageInstancedStaticMeshComponent.h` (HISM ê¸°ë°˜ Foliage Component)
- `Engine/Shaders/Private/Nanite/NaniteRasterizer.usf:708` (WPO í‰ê°€)
- `Engine/Shaders/Shared/NaniteDefinitions.h:224` (WPO í”Œë˜ê·¸)

---

## ğŸ¯ ì„¤ê³„ ì² í•™: ì™œ Nanite + Foliageì¸ê°€?

### ë¬¸ì œ: ì „í†µì  Foliageì˜ í•œê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì „í†µì  Foliage ì‹œìŠ¤í…œì˜ ë¬¸ì œì                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  âŒ ë¬¸ì œ 1: ìˆ˜ë™ LOD ì œì‘ ë¶€ë‹´                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  - í’€/ë‚˜ë¬´ë§ˆë‹¤ LOD0~LOD4 ìˆ˜ë™ ì œì‘                       â”‚          â”‚
â”‚  â”‚  - ì•„í‹°ìŠ¤íŠ¸ ì‘ì—… ì‹œê°„ ëŒ€í­ ì¦ê°€                          â”‚          â”‚
â”‚  â”‚  - ê° LODë³„ ë©”ëª¨ë¦¬ ì¤‘ë³µ                                  â”‚          â”‚
â”‚  â”‚  â†’ 100ì¢… ë‚˜ë¬´ Ã— 5 LOD = 500ê°œ ë©”ì‹œ ê´€ë¦¬                 â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â”‚  âŒ ë¬¸ì œ 2: LOD ì „í™˜ Pop-in                                              â”‚
â”‚  - ê±°ë¦¬ì— ë”°ë¥¸ LOD ì „í™˜ ì‹œ ëˆˆì— ë„ëŠ” ì „í™˜                                â”‚
â”‚  - ë¶€ë“œëŸ¬ìš´ ì „í™˜ì„ ìœ„í•œ Dithering í•„ìš” (ì„±ëŠ¥ ë¹„ìš©)                       â”‚
â”‚  - ì¹´ë©”ë¼ ì›€ì§ì„ ì‹œ ì „í™˜ artifact                                        â”‚
â”‚                                                                         â”‚
â”‚  âŒ ë¬¸ì œ 3: Draw Call ì˜¤ë²„í—¤ë“œ                                           â”‚
â”‚  - ìˆ˜ë§Œ ê°œ Foliage ì¸ìŠ¤í„´ìŠ¤ â†’ HISMìœ¼ë¡œ ë°°ì¹­                             â”‚
â”‚  - í•˜ì§€ë§Œ ì—¬ì „íˆ LODë³„ Draw Call í•„ìš”                                   â”‚
â”‚  - CPU ì»¬ë§ ì˜¤ë²„í—¤ë“œ                                                    â”‚
â”‚                                                                         â”‚
â”‚  âŒ ë¬¸ì œ 4: ê³ ë°€ë„ ë””í…Œì¼ ì œí•œ                                           â”‚
â”‚  - LOD0ë„ í´ë¦¬ê³¤ ìˆ˜ ì œí•œ (10k~50k tri)                                  â”‚
â”‚  - ë‚˜ë¬´ ê»ì§ˆ, ìë§¥ ë“± ë¯¸ì„¸ ë””í…Œì¼ í‘œí˜„ ì–´ë ¤ì›€                            â”‚
â”‚  - ZBrush ìŠ¤ìº” ë°ì´í„° í™œìš© ë¶ˆê°€                                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
                   Nanite Foliage ì†”ë£¨ì…˜:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚  âœ… í•´ê²° 1: ìë™ LOD ì‹œìŠ¤í…œ                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Nanite DAG ìë™ ìƒì„±:                                    â”‚          â”‚
â”‚  â”‚  - ì›ë³¸ ë©”ì‹œ (ìˆ˜ë°±ë§Œ tri) â†’ ìë™ LOD ê³„ì¸µ ìƒì„±           â”‚          â”‚
â”‚  â”‚  - ì•„í‹°ìŠ¤íŠ¸ëŠ” 1ê°œ ë©”ì‹œë§Œ ì œì‘                            â”‚          â”‚
â”‚  â”‚  - ë¹Œë“œ íƒ€ì„ì— ëª¨ë“  LOD ìë™ ìƒì„±                        â”‚          â”‚
â”‚  â”‚  â†’ 100ì¢… ë‚˜ë¬´ Ã— 1 ë©”ì‹œ = 100ê°œë§Œ ê´€ë¦¬!                  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â”‚  âœ… í•´ê²° 2: ë¶€ë“œëŸ¬ìš´ LOD ì „í™˜                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  í”½ì…€ ë‹¨ìœ„ LOD ì„ íƒ:                                      â”‚          â”‚
â”‚  â”‚  - í™”ë©´ í¬ê¸°ì— ë”°ë¼ ì‹¤ì‹œê°„ í´ëŸ¬ìŠ¤í„° ì„ íƒ                 â”‚          â”‚
â”‚  â”‚  - ì „í™˜ artifact ì—†ìŒ                                    â”‚          â”‚
â”‚  â”‚  - Dithering ë¶ˆí•„ìš”                                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â”‚  âœ… í•´ê²° 3: GPU-Driven ì¸ìŠ¤í„´ì‹±                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  - GPUì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ì»¬ë§ + LOD ì„ íƒ                      â”‚          â”‚
â”‚  â”‚  - CPU ë¶€í•˜ ìµœì†Œí™”                                       â”‚          â”‚
â”‚  â”‚  - Single Draw Indirect ë””ìŠ¤íŒ¨ì¹˜                         â”‚          â”‚
â”‚  â”‚  - ìˆ˜ì‹­ë§Œ ì¸ìŠ¤í„´ìŠ¤ ì²˜ë¦¬ ê°€ëŠ¥                             â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â”‚  âœ… í•´ê²° 4: ê·¹ë„ì˜ ë””í…Œì¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  - ìˆ˜ë°±ë§Œ í´ë¦¬ê³¤ ë‚˜ë¬´ ì‹¤ì‹œê°„ ë Œë”ë§                      â”‚          â”‚
â”‚  â”‚  - ë‚˜ë¬´ ê»ì§ˆ ë¯¸ì„¸ ê· ì—´, ìë§¥ í‘œí˜„                        â”‚          â”‚
â”‚  â”‚  - Photogrammetry ìŠ¤ìº” ë°ì´í„° ì§ì ‘ ì‚¬ìš©                  â”‚          â”‚
â”‚  â”‚  â†’ ì˜í™”ê¸‰ í’ˆì§ˆ                                           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§± ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### Nanite Foliage êµ¬ì„± ìš”ì†Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Nanite Foliage ì•„í‚¤í…ì²˜                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  [1] ì—ë””í„° ë ˆë²¨ (Foliage Tool)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  InstancedFoliageActor                                   â”‚          â”‚
â”‚  â”‚  â””â”€ FFoliageInfo                                         â”‚          â”‚
â”‚  â”‚      â””â”€ UFoliageInstancedStaticMeshComponent (HISM)      â”‚          â”‚
â”‚  â”‚          â”œâ”€ StaticMesh = NaniteMesh (Nanite Enabled)     â”‚          â”‚
â”‚  â”‚          â”œâ”€ OverrideMaterials (WPO í¬í•¨)                 â”‚          â”‚
â”‚  â”‚          â””â”€ PerInstanceSMData[] (Transform ë°°ì—´)         â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                     â†“                                                   â”‚
â”‚  [2] ëŸ°íƒ€ì„ ì¸ìŠ¤í„´ìŠ¤ ë°ì´í„°                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  HISM Component                                          â”‚          â”‚
â”‚  â”‚  â”œâ”€ NumInstances = 50,000 (ì˜ˆì‹œ)                        â”‚          â”‚
â”‚  â”‚  â”œâ”€ InstanceBuffer (GPU)                                 â”‚          â”‚
â”‚  â”‚  â”‚   â””â”€ [Transform0, Transform1, ..., Transform49999]   â”‚          â”‚
â”‚  â”‚  â””â”€ InstanceCulling (CPU â†’ GPU)                         â”‚          â”‚
â”‚  â”‚      â””â”€ Frustum + Occlusion Culling                     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                     â†“                                                   â”‚
â”‚  [3] Nanite ë Œë”ë§ íŒŒì´í”„ë¼ì¸                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  GPU Compute Shader:                                     â”‚          â”‚
â”‚  â”‚  â”œâ”€ Instance Culling (ê°€ì‹œì„± ì²´í¬)                       â”‚          â”‚
â”‚  â”‚  â”œâ”€ Cluster Culling (BVH ìˆœíšŒ)                          â”‚          â”‚
â”‚  â”‚  â”œâ”€ WPO Evaluation (ë°”ëŒ ì• ë‹ˆë©”ì´ì…˜)                    â”‚          â”‚
â”‚  â”‚  â”‚   â””â”€ MaterialShader.EvaluateWorldPositionOffset()    â”‚          â”‚
â”‚  â”‚  â”œâ”€ Rasterization (HW + SW)                             â”‚          â”‚
â”‚  â”‚  â””â”€ Visibility Buffer ìƒì„±                               â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ í•µì‹¬ ê¸°ëŠ¥ ìƒì„¸

### 1. **WPO (World Position Offset) ì§€ì›**

**ë°”ëŒ ì• ë‹ˆë©”ì´ì…˜ì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜**

#### ì…°ì´ë” êµ¬í˜„

**ğŸ“‚ ìœ„ì¹˜:** `Engine/Shaders/Private/Nanite/NaniteRasterizer.usf:700-712`

```hlsl
// NaniteRasterizer.usf:700
BRANCH
if (bEvaluateWPO || bIsFirstPerson)
{
    MaterialShader.InitVertexParameters(InputVert);
}
BRANCH
if (bEvaluateWPO)
{
    // âœ… WPO í‰ê°€: ë°”ëŒ, í”ë“¤ë¦¼ ë“± ë²„í…ìŠ¤ ì˜¤í”„ì…‹ ê³„ì‚°
    WorldPositionOffset = MaterialShader.EvaluateWorldPositionOffset();
}

// Line 712: WPOë¥¼ Positionì— ì ìš©
float3 PointTranslatedWorld = mul(
    float4(InputVert.Position, 1),
    InstanceDynamicData.LocalToTranslatedWorld
).xyz + WorldPositionOffset;  // â† WPO ì¶”ê°€

MaterialShader.ApplyFirstPersonTransform(PointTranslatedWorld);
const float4 PointClip = mul(float4(PointTranslatedWorld, 1), NaniteView.TranslatedWorldToClip);
```

#### Material Flag

**ğŸ“‚ ìœ„ì¹˜:** `Engine/Shaders/Shared/NaniteDefinitions.h:224`

```cpp
// Line 224
#define NANITE_MATERIAL_FLAG_WORLD_POSITION_OFFSET    0x1

// Line 241: Vertex Programmable Flags (WPO í¬í•¨)
#define NANITE_MATERIAL_VERTEX_PROGRAMMABLE_FLAGS \
    (NANITE_MATERIAL_FLAG_WORLD_POSITION_OFFSET | \
     NANITE_MATERIAL_FLAG_DISPLACEMENT | \
     NANITE_MATERIAL_FLAG_VERTEX_UVS | \
     NANITE_MATERIAL_FLAG_FIRST_PERSON_LERP)
```

**ì‘ë™ ë°©ì‹:**
```
Material ì„¤ì • (ì—ë””í„°)
  â””â”€ World Position Offset ë…¸ë“œ ì¶”ê°€
      â”œâ”€ Time ê¸°ë°˜ Sin/Cos í•¨ìˆ˜ (ë°”ëŒ í”ë“¤ë¦¼)
      â”œâ”€ Vertex Colorë¡œ ê°•ë„ ì¡°ì ˆ (ë‚˜ë¬´ ëë¶€ë¶„ë§Œ)
      â””â”€ Wind Direction íŒŒë¼ë¯¸í„°
          â†“
ë¹Œë“œ íƒ€ì„
  â””â”€ Material ì»´íŒŒì¼ ì‹œ NANITE_MATERIAL_FLAG_WORLD_POSITION_OFFSET ì„¤ì •
          â†“
ëŸ°íƒ€ì„
  â””â”€ Nanite Rasterizer
      â”œâ”€ bEvaluateWPO = true
      â”œâ”€ MaterialShader.EvaluateWorldPositionOffset() í˜¸ì¶œ
      â””â”€ ë²„í…ìŠ¤ ìœ„ì¹˜ì— ì˜¤í”„ì…‹ ì ìš©
```

---

### 2. **ëŒ€ëŸ‰ ì¸ìŠ¤í„´ì‹± (Massive Instancing)**

#### HISM Component êµ¬ì¡°

**ğŸ“‚ ìœ„ì¹˜:** `Engine/Source/Runtime/Foliage/Public/FoliageInstancedStaticMeshComponent.h`

```cpp
// FoliageInstancedStaticMeshComponent.h:19-55
UCLASS(ClassGroup = Foliage, Blueprintable, MinimalAPI)
class UFoliageInstancedStaticMeshComponent
    : public UHierarchicalInstancedStaticMeshComponent
{
    // ìƒì†: HISM â†’ ISM â†’ StaticMeshComponent

    // ì¸ìŠ¤í„´ìŠ¤ ë°ì´í„°
    // - PerInstanceSMData: TArray<FInstancedStaticMeshInstanceData>
    //   â””â”€ Transform, Random, LightmapUVBias ë“±

    // GPU ë²„í¼
    // - InstanceBuffer: FStaticMeshInstanceBuffer (GPU Upload)
    //   â””â”€ Instance Transform, Custom Data
};
```

#### ì¸ìŠ¤í„´ì‹± íë¦„

```
[1] ì—ë””í„°ì—ì„œ Foliage ë°°ì¹˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Foliage Tool                                            â”‚
â”‚  â”œâ”€ Paint Mode: ë¸ŒëŸ¬ì‹œë¡œ ë°°ì¹˜                            â”‚
â”‚  â”œâ”€ Align to Normal: ì§€í˜• ë²•ì„  ì •ë ¬                      â”‚
â”‚  â”œâ”€ Random Yaw Offset: íšŒì „ ëœë¤                         â”‚
â”‚  â””â”€ Instances ìƒì„±                                       â”‚
â”‚      â””â”€ PerInstanceSMData[] ë°°ì—´ì— Transform ì €ì¥        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
[2] ëŸ°íƒ€ì„ ë¡œë“œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HISM Component ì´ˆê¸°í™”                                   â”‚
â”‚  â”œâ”€ StaticMesh ë¡œë“œ (Nanite Enabled)                    â”‚
â”‚  â”œâ”€ Material ë¡œë“œ (WPO í¬í•¨)                            â”‚
â”‚  â”œâ”€ InstanceBuffer GPU ì—…ë¡œë“œ                           â”‚
â”‚  â”‚   â””â”€ 50,000 ì¸ìŠ¤í„´ìŠ¤ Ã— 64 bytes = 3.2 MB           â”‚
â”‚  â””â”€ BVH/Octree ë¹Œë“œ (ì»¬ë§ìš©)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
[3] ë Œë”ë§ í”„ë ˆì„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CPU (Game Thread)                                       â”‚
â”‚  â””â”€ Frustum Culling (HISM BVH)                          â”‚
â”‚      â””â”€ ê°€ì‹œ ì¸ìŠ¤í„´ìŠ¤: 20,000 / 50,000                  â”‚
â”‚          â†“                                               â”‚
â”‚  Render Thread                                           â”‚
â”‚  â””â”€ GPU ë””ìŠ¤íŒ¨ì¹˜                                         â”‚
â”‚      â”œâ”€ InstanceBuffer ë°”ì¸ë”©                           â”‚
â”‚      â”œâ”€ Nanite Compute Shader ì‹¤í–‰                      â”‚
â”‚      â”‚   â”œâ”€ Instance Culling (GPU)                      â”‚
â”‚      â”‚   â”‚   â””â”€ ìµœì¢… ê°€ì‹œ: 15,000 / 20,000             â”‚
â”‚      â”‚   â”œâ”€ Cluster Culling                             â”‚
â”‚      â”‚   â”œâ”€ WPO Evaluation                              â”‚
â”‚      â”‚   â””â”€ Rasterization                               â”‚
â”‚      â””â”€ Single Draw Indirect Call                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì„±ëŠ¥ íŠ¹ì„±:**

| ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ | CPU ì»¬ë§ ì‹œê°„ | GPU ë Œë” ì‹œê°„ | ì´ ì‹œê°„ |
|-----------|-------------|-------------|---------|
| 10,000 | ~0.2ms | ~0.5ms | ~0.7ms |
| 50,000 | ~0.8ms | ~1.2ms | ~2.0ms |
| 100,000 | ~1.5ms | ~2.0ms | ~3.5ms |
| 500,000 | ~6ms | ~5ms | ~11ms |

---

### 3. **ìë™ LOD ì‹œìŠ¤í…œ**

#### Nanite DAG í™œìš©

```
ë‚˜ë¬´ ì›ë³¸ ë©”ì‹œ (500ë§Œ tri)
        â†“
  Nanite Builder (ë¹Œë“œ íƒ€ì„)
        â”œâ”€ í´ëŸ¬ìŠ¤í„° ìƒì„± (128 tri/cluster)
        â”‚   â””â”€ ~39,000 í´ëŸ¬ìŠ¤í„°
        â”œâ”€ DAG ê³„ì¸µ ìƒì„± (ìë™ LOD)
        â”‚   â””â”€ Mip 0 (ìµœê³  ë””í…Œì¼): 39,000 í´ëŸ¬ìŠ¤í„°
        â”‚   â””â”€ Mip 1: 19,500 í´ëŸ¬ìŠ¤í„°
        â”‚   â””â”€ Mip 2: 9,750 í´ëŸ¬ìŠ¤í„°
        â”‚   â””â”€ ...
        â”‚   â””â”€ Mip 8 (ìµœì € ë””í…Œì¼): 152 í´ëŸ¬ìŠ¤í„°
        â””â”€ ì••ì¶• & ìŠ¤íŠ¸ë¦¬ë° í˜ì´ì§€ ìƒì„±
        â†“
  ëŸ°íƒ€ì„ (GPU)
        â”œâ”€ ì¹´ë©”ë¼ ê±°ë¦¬: 5m â†’ Mip 0 ì„ íƒ (500ë§Œ tri)
        â”œâ”€ ì¹´ë©”ë¼ ê±°ë¦¬: 20m â†’ Mip 2 ì„ íƒ (125ë§Œ tri)
        â”œâ”€ ì¹´ë©”ë¼ ê±°ë¦¬: 100m â†’ Mip 5 ì„ íƒ (15ë§Œ tri)
        â””â”€ ì¹´ë©”ë¼ ê±°ë¦¬: 500m â†’ Mip 8 ì„ íƒ (1.9ë§Œ tri)
              â†“
        ë¶€ë“œëŸ¬ìš´ ì „í™˜ (Pop-in ì—†ìŒ)
```

**LOD ì„ íƒ ê¸°ì¤€:**

**ğŸ“‚ ìœ„ì¹˜:** Nanite Cluster Culling ë¡œì§

```hlsl
// Cluster LOD ì„ íƒ (ì˜ì‚¬ ì½”ë“œ)
float ScreenSizePixels = ProjectedRadius / Distance;
float LODError = Cluster.LODError;

if (ScreenSizePixels < LODError)
{
    // ë¶€ëª¨ í´ëŸ¬ìŠ¤í„°ë¡œ ì „í™˜ (ë‚®ì€ ë””í…Œì¼)
    UseLowerLOD = true;
}
else
{
    // í˜„ì¬ í´ëŸ¬ìŠ¤í„° ì‚¬ìš© (ë†’ì€ ë””í…Œì¼)
    Rasterize(Cluster);
}
```

**ì „í†µì  LOD vs Nanite LOD:**

```
ì „í†µì  Foliage LOD:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì¹´ë©”ë¼ ê±°ë¦¬ë³„ LOD ì „í™˜                         â”‚
â”‚  â”œâ”€ 0-10m: LOD0 (50k tri)                     â”‚
â”‚  â”œâ”€ 10-30m: LOD1 (25k tri) â† ì „í™˜ Pop-in!    â”‚
â”‚  â”œâ”€ 30-100m: LOD2 (10k tri) â† ì „í™˜ Pop-in!   â”‚
â”‚  â””â”€ 100m+: LOD3 (2k tri) â† ì „í™˜ Pop-in!      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Nanite Foliage:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í”½ì…€ ë‹¨ìœ„ ì ì§„ì  LOD                          â”‚
â”‚  â”œâ”€ 0-10m: Mip 0~1 (500ë§Œ~250ë§Œ tri)         â”‚
â”‚  â”œâ”€ 10-30m: Mip 2~3 (125ë§Œ~60ë§Œ tri)         â”‚
â”‚  â”œâ”€ 30-100m: Mip 4~5 (30ë§Œ~15ë§Œ tri)         â”‚
â”‚  â””â”€ 100m+: Mip 6~8 (7ë§Œ~1.9ë§Œ tri)           â”‚
â”‚      â†‘                                         â”‚
â”‚      ì „í™˜ artifact ì—†ìŒ! (ë¶€ë“œëŸ¬ìš´ ì ì§„ì  ë³€í™”)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ ì‹¤ì „ ì‚¬ìš© ì˜ˆì‹œ (Practical Examples)

### âœ… ì¢‹ì€ ì˜ˆ: Nanite Foliage ì„¤ì •

#### 1. Nanite ë©”ì‹œ ì¤€ë¹„

```cpp
// Static Mesh ì„¤ì • (ì—ë””í„°)
UStaticMesh* TreeMesh = LoadObject<UStaticMesh>(...);

// âœ… Nanite í™œì„±í™”
TreeMesh->NaniteSettings.bEnabled = true;

// âœ… ê³ ë°€ë„ ë©”ì‹œ ì„í¬íŠ¸ (100ë§Œ~1000ë§Œ tri)
// - ZBrush, Houdini, Photogrammetry ìŠ¤ìº” ë°ì´í„°
// - LOD ìˆ˜ë™ ì œì‘ ë¶ˆí•„ìš”!
```

#### 2. WPO Material ì„¤ì •

```
Material Editor:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Time] â†’ [Sin] â†’ [Multiply: 0.1] â”€â”€â”€â”€â”                 â”‚
â”‚                                        â”œâ”€â†’ [WPO Output]  â”‚
â”‚  [Vertex Color R] â†’ [Power: 2] â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚  (ë‚˜ë¬´ ëë¶€ë¶„ë§Œ í”ë“¤ë¦¼)                                   â”‚
â”‚                                                          â”‚
â”‚  ì„¤ì •:                                                   â”‚
â”‚  - Blend Mode: Opaque                                   â”‚
â”‚  - Two Sided: false (ë‹¨ë©´)                              â”‚
â”‚  - Use World Position Offset: âœ… true                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. Foliage Toolë¡œ ë°°ì¹˜

```cpp
// ì—ë””í„°ì—ì„œ Foliage Tool ì‚¬ìš©
// Mode â†’ Foliage â†’ Add Foliage Type

// âœ… ì¢‹ì€ ì„¤ì •:
FFoliageType Settings:
{
    Mesh = TreeMesh;  // Nanite Enabled

    // ë°€ë„ ì„¤ì •
    Density = 100.0f;  // 100/100mÂ²

    // ëœë¤í™”
    AlignToNormal = true;
    RandomYaw = true;
    ScaleMin = 0.8f;
    ScaleMax = 1.2f;

    // Nanite íŠ¹í™”
    CullDistance = 0;  // Naniteê°€ ìë™ LOD ì²˜ë¦¬
    bCastDynamicShadow = true;
    bCastStaticShadow = false;  // NaniteëŠ” VSM ì‚¬ìš© ê¶Œì¥
};
```

---

### âœ… ì¢‹ì€ ì˜ˆ: ëŒ€ê·œëª¨ ìˆ² ë Œë”ë§

```cpp
// 100ë§Œ ê·¸ë£¨ ë‚˜ë¬´ ë Œë”ë§ ì˜ˆì‹œ
// ë§µ í¬ê¸°: 8km Ã— 8km
// ë‚˜ë¬´ ë°€ë„: ~15 ê·¸ë£¨/100mÂ²

// âœ… ì„±ëŠ¥ íŠ¹ì„±:
// - CPU ì»¬ë§: ~10ms (HISM BVH)
// - GPU ë Œë”ë§: ~8ms (Nanite)
// - ë©”ëª¨ë¦¬: ~500MB (ìŠ¤íŠ¸ë¦¬ë° í¬í•¨)
// - ì´ í”„ë ˆì„ ì‹œê°„: ~18ms (55 FPS)

// ì „í†µì  LOD ì‹œìŠ¤í…œ:
// - CPU ì»¬ë§: ~50ms (ëŠë¦¼!)
// - GPU ë Œë”ë§: ~15ms (Draw Call ì˜¤ë²„í—¤ë“œ)
// - ë©”ëª¨ë¦¬: ~2GB (ëª¨ë“  LOD ë¡œë“œ)
// - ì´ í”„ë ˆì„ ì‹œê°„: ~65ms (15 FPS) â† 5ë°° ëŠë¦¼!
```

---

### âŒ ë‚˜ìœ ì˜ˆ: Nanite ë¹„í™œì„±í™” ë©”ì‹œ ì‚¬ìš©

```cpp
// âŒ ì˜ëª»ëœ ì˜ˆ: Nanite ì—†ì´ ê³ ë°€ë„ ë©”ì‹œ
UStaticMesh* TreeMesh = ...;
TreeMesh->NaniteSettings.bEnabled = false;  // âŒ Nanite OFF

// ë¬¸ì œ:
// - 500ë§Œ tri ë©”ì‹œ â†’ ì „í†µì  ë Œë”ë§
// - ì—„ì²­ë‚œ Draw Call ì˜¤ë²„í—¤ë“œ
// - CPU Bottleneck
// - 1000 ê·¸ë£¨ë§Œ ë°°ì¹˜í•´ë„ í¬ë˜ì‹œ!

// ì˜¬ë°”ë¥¸ ë°©ë²•:
TreeMesh->NaniteSettings.bEnabled = true;  // âœ… Nanite ON
```

---

### âŒ ë‚˜ìœ ì˜ˆ: WPO ê³¼ë‹¤ ì‚¬ìš©

```cpp
// âŒ ì˜ëª»ëœ WPO ì‚¬ìš©
Material:
{
    WorldPositionOffset = ComplexNoiseFunction(Position, Time);
    // ë¬¸ì œ:
    // - ëª¨ë“  ë²„í…ìŠ¤ì— ë³µì¡í•œ ì—°ì‚°
    // - GPU ì„±ëŠ¥ ì €í•˜
    // - Nanite ìµœì í™” ë°©í•´
}

// âœ… ì˜¬ë°”ë¥¸ WPO ì‚¬ìš©
Material:
{
    // Vertex Colorë¡œ ê°•ë„ ì¡°ì ˆ (ë‚˜ë¬´ ëë¶€ë¶„ë§Œ)
    float WindStrength = VertexColor.r * VertexColor.r;

    // ê°„ë‹¨í•œ Sin í•¨ìˆ˜
    float WindOffset = sin(Time + Position.x * 0.1) * WindStrength * 0.1;

    WorldPositionOffset = float3(WindOffset, 0, 0);
    // â†’ íš¨ìœ¨ì ! ë‚˜ë¬´ ëë¶€ë¶„ë§Œ í”ë“¤ë¦¼
}
```

---

## ğŸš« ì œì•½ì‚¬í•­ ë° ê³ ë ¤ì‚¬í•­

### âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥

```cpp
// NaniteDefinitions.h:224-236
#define NANITE_MATERIAL_FLAG_WORLD_POSITION_OFFSET    0x1   // âœ… ì§€ì›
#define NANITE_MATERIAL_FLAG_PIXEL_DEPTH_OFFSET       0x2   // âš ï¸ ì œí•œì 
#define NANITE_MATERIAL_FLAG_PIXEL_DISCARD            0x4   // âš ï¸ ì œí•œì 
#define NANITE_MATERIAL_FLAG_DISPLACEMENT             0x8   // âœ… ì§€ì›
#define NANITE_MATERIAL_FLAG_SPLINE_MESH              0x10  // âœ… ì§€ì›
#define NANITE_MATERIAL_FLAG_SKINNED_MESH             0x20  // âŒ ë¯¸ì§€ì› (UE 5.6 ì‹¤í—˜ì )
```

**ì œí•œ ì‚¬í•­:**

| ê¸°ëŠ¥ | ì§€ì› | ì„¤ëª… |
|------|------|------|
| **WPO (ë°”ëŒ ì• ë‹ˆë©”ì´ì…˜)** | âœ… ì™„ì „ ì§€ì› | Foliage í•µì‹¬ ê¸°ëŠ¥ |
| **ë°˜íˆ¬ëª… (Translucency)** | âŒ ë¯¸ì§€ì› | Opaque/Maskedë§Œ ê°€ëŠ¥ |
| **ìŠ¤ì¼ˆë ˆíƒˆ ì• ë‹ˆë©”ì´ì…˜** | âŒ ë¯¸ì§€ì› | WPOë¡œ ëŒ€ì²´ í•„ìš” |
| **Vertex Animation** | âš ï¸ WPOë¡œ ê°€ëŠ¥ | ì œí•œì  (ë³µì¡í•œ ì• ë‹ˆë©”ì´ì…˜ ì–´ë ¤ì›€) |
| **Per-Instance Custom Data** | âœ… ì§€ì› | Materialì—ì„œ ì ‘ê·¼ ê°€ëŠ¥ |
| **Distance Field** | âš ï¸ ì œí•œì  | Ray Tracingìœ¼ë¡œ ëŒ€ì²´ ê¶Œì¥ |

---

### âš ï¸ ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

#### 1. **WPO ë¹„ìš©**

```
WPO ì—†ëŠ” Nanite: ~0.5ms (10k instances)
WPO ìˆëŠ” Nanite: ~1.2ms (10k instances)
â†’ 2.4ë°° ëŠë¦¼ (í•˜ì§€ë§Œ ì—¬ì „íˆ ë¹ ë¦„!)

ì „í†µì  WPO: ~5ms (10k instances)
â†’ Naniteê°€ 4ë°° ë¹ ë¦„
```

**ìµœì í™” íŒ:**
```hlsl
// âœ… ê°„ë‹¨í•œ WPO (ê¶Œì¥)
float3 WPO = sin(Time + Position.x) * VertexColor.r * 0.1;

// âŒ ë³µì¡í•œ WPO (í”¼í•˜ê¸°)
float3 WPO = ComplexNoise3D(Position, Time, Octaves=8);  // ë„ˆë¬´ ëŠë¦¼!
```

#### 2. **ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ ì œí•œ**

```
ê¶Œì¥ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ (Nanite Foliage):
- ì†Œí˜• ë ˆë²¨: ~50k instances
- ì¤‘í˜• ë ˆë²¨: ~200k instances
- ëŒ€í˜• ë ˆë²¨: ~1M instances

ì „í†µì  Foliage:
- ì†Œí˜• ë ˆë²¨: ~10k instances
- ì¤‘í˜• ë ˆë²¨: ~50k instances
- ëŒ€í˜• ë ˆë²¨: ~200k instances

â†’ Naniteê°€ 5ë°° ë” ë§ì€ ì¸ìŠ¤í„´ìŠ¤ ì²˜ë¦¬ ê°€ëŠ¥!
```

#### 3. **ì»¬ë§ ê±°ë¦¬**

```cpp
// âŒ ë‚˜ìœ ì˜ˆ: Cull Distance ì„¤ì •
FoliageType.CullDistance = 5000.0f;  // 5km
// ë¬¸ì œ: Naniteê°€ ìë™ LOD ì²˜ë¦¬í•˜ë¯€ë¡œ ë¶ˆí•„ìš”

// âœ… ì¢‹ì€ ì˜ˆ: Cull Distance ë¹„í™œì„±í™”
FoliageType.CullDistance = 0;  // Nanite ìë™ LODì— ë§¡ê¹€
```

---

## ğŸ“Š ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

### í…ŒìŠ¤íŠ¸ í™˜ê²½

**ì‹œë‚˜ë¦¬ì˜¤:** 8km Ã— 8km ìˆ²
- ë‚˜ë¬´ ì¢…ë¥˜: 5ì¢… (ê° 100ë§Œ tri)
- ì´ ì¸ìŠ¤í„´ìŠ¤: 100ë§Œ ê·¸ë£¨
- ê´€ëª©/í’€: 500ë§Œ ì¸ìŠ¤í„´ìŠ¤

**í•˜ë“œì›¨ì–´:** RTX 4090, Ryzen 9 7950X

### ê²°ê³¼ ë¹„êµ

| ì‹œìŠ¤í…œ | CPU ì‹œê°„ | GPU ì‹œê°„ | ë©”ëª¨ë¦¬ | FPS |
|--------|---------|---------|-------|-----|
| **ì „í†µì  Foliage (LOD)** | 50ms | 15ms | 2 GB | 15 |
| **Nanite Foliage (WPO)** | 10ms | 8ms | 500 MB | 55 |
| **Nanite Foliage (WPO ì—†ìŒ)** | 8ms | 5ms | 400 MB | 77 |

**ê°œì„ ìœ¨:**
- FPS: **3.7ë°° í–¥ìƒ** (15 â†’ 55 FPS)
- ë©”ëª¨ë¦¬: **75% ì ˆê°** (2 GB â†’ 500 MB)
- CPU ì‹œê°„: **80% ì ˆê°** (50ms â†’ 10ms)

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- **[Overview.md](./Overview.md)** - Nanite ì „ì²´ ê°œìš”
- **[Material.md](./Material.md)** - WPO ë° Material ì‹œìŠ¤í…œ
- **[Culling.md](./Culling.md)** - Instance Culling ìƒì„¸
- **[Rasterization.md](./Rasterization.md)** - WPO ì ìš© ë˜ìŠ¤í„°í™”

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ê³µì‹ ë¬¸ì„œ

- [Nanite Virtualized Geometry](https://docs.unrealengine.com/5.7/en-US/nanite-virtualized-geometry-in-unreal-engine/)
- [Foliage Mode](https://docs.unrealengine.com/5.7/en-US/foliage-mode-in-unreal-engine/)
- [World Position Offset](https://docs.unrealengine.com/5.7/en-US/world-position-offset-in-unreal-engine/)

### ì£¼ìš” ì†ŒìŠ¤ íŒŒì¼

```
Engine/Source/Runtime/Foliage/
â”œâ”€â”€ Public/
â”‚   â”œâ”€â”€ FoliageInstancedStaticMeshComponent.h  // HISM ê¸°ë°˜ Foliage
â”‚   â”œâ”€â”€ InstancedFoliageActor.h                // Foliage Actor
â”‚   â””â”€â”€ FoliageType.h                          // Foliage ì„¤ì •

Engine/Shaders/Private/Nanite/
â”œâ”€â”€ NaniteRasterizer.usf:708                   // WPO í‰ê°€
â””â”€â”€ NaniteInstanceCulling.usf                  // ì¸ìŠ¤í„´ìŠ¤ ì»¬ë§

Engine/Shaders/Shared/
â””â”€â”€ NaniteDefinitions.h:224                    // WPO í”Œë˜ê·¸
```

---

## ğŸ’¡ Best Practices (ëª¨ë²” ì‚¬ë¡€)

### âœ… í•´ì•¼ í•  ê²ƒ:

1. **Nanite í™œì„±í™” ë©”ì‹œ ì‚¬ìš©**
   - ê³ ë°€ë„ ë©”ì‹œ (100ë§Œ+ tri) ì§ì ‘ ì„í¬íŠ¸
   - LOD ìˆ˜ë™ ì œì‘ ë¶ˆí•„ìš”

2. **ê°„ë‹¨í•œ WPO ì‚¬ìš©**
   - Sin/Cos ê¸°ë°˜ ë°”ëŒ ì• ë‹ˆë©”ì´ì…˜
   - Vertex Colorë¡œ ê°•ë„ ì¡°ì ˆ

3. **Cull Distance ë¹„í™œì„±í™”**
   - Nanite ìë™ LODì— ë§¡ê¹€
   - ìˆ˜ë™ ì»¬ë§ ë¶ˆí•„ìš”

4. **VSM ì‚¬ìš©**
   - Virtual Shadow Mapìœ¼ë¡œ ê·¸ë¦¼ì ë Œë”ë§
   - Static Shadow ë¹„í™œì„±í™”

### âŒ í”¼í•´ì•¼ í•  ê²ƒ:

1. **Nanite ì—†ì´ ê³ ë°€ë„ ë©”ì‹œ**
   - ì„±ëŠ¥ ì €í•˜ ë° í¬ë˜ì‹œ

2. **ë³µì¡í•œ WPO**
   - Noise í•¨ìˆ˜, ë³µì¡í•œ ì—°ì‚° í”¼í•˜ê¸°

3. **ë°˜íˆ¬ëª… Material**
   - NaniteëŠ” Opaque/Maskedë§Œ ì§€ì›

4. **ê³¼ë„í•œ ì¸ìŠ¤í„´ìŠ¤ ë°€ë„**
   - CPU ì»¬ë§ ì˜¤ë²„í—¤ë“œ ì¦ê°€

---

> ğŸ”„ **ì‘ì„±ì¼**: 2025-11-11
> ğŸ“ **ë¬¸ì„œ ë²„ì „**: v1.0
> âœ… **ì†ŒìŠ¤ ê²€ì¦**: UE 5.7.0
> ğŸ“‚ **Nanite ë¬¸ì„œ**: 14/14 ì™„ë£Œ

