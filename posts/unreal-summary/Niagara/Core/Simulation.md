---
title: "Simulation - Niagara λ°νƒ€μ„ μ‹λ®¬λ μ΄μ… (Niagara Runtime Simulation)"
date: "2026-02-18"
status: "stable"
project: "UnrealEngine"
lang: "ko"
category: "unreal-summary"
track: "Niagara"
tags: ["unreal", "Niagara", "Core"]
---
# Simulation - Niagara λ°νƒ€μ„ μ‹λ®¬λ μ΄μ… (Niagara Runtime Simulation)

## π§­ κ°μ” (Overview)

**Niagara Simulation System**μ€ **μ»΄νμΌλ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤μ λ΅ μ‹¤ν–‰ν•μ—¬ νν‹°ν΄μ„ μ‹λ®¬λ μ΄μ…ν•λ” λ°νƒ€μ„ μ‹μ¤ν…**μ…λ‹λ‹¤. 3-tier μ•„ν‚¤ν…μ²λ¥Ό ν†µν•΄ λ™μΌν• μ‹μ¤ν…μ λ‹¤μ μΈμ¤ν„΄μ¤λ¥Ό λ°°μΉλ΅ λ¬¶μ–΄ ν¨μ¨μ μΌλ΅ μ‹λ®¬λ μ΄μ…ν•©λ‹λ‹¤.

**ν•µμ‹¬ μ—­ν• :**
- **λ°°μΉ μ‹λ®¬λ μ΄μ…**: λ™μΌ UNiagaraSystemμ λ‹¤μ μΈμ¤ν„΄μ¤λ¥Ό λ°°μΉλ΅ λ¬¶μ–΄ μ²λ¦¬
- **λ©€ν‹°μ¤λ λ“ μ‹¤ν–‰**: Concurrent TickμΌλ΅ λ³‘λ ¬ μ‹λ®¬λ μ΄μ…
- **SOA λ°μ΄ν„° λ μ΄μ•„μ›ƒ**: SIMD μµμ ν™”λ¥Ό μ„ν• Structure of Arrays
- **CPU/GPU λ¶„κΈ°**: SimTargetμ— λ”°λΌ μλ™μΌλ΅ μ‹¤ν–‰ κ²½λ΅ μ „ν™
- **DataSet κ΄€λ¦¬**: νν‹°ν΄ λ°μ΄ν„°μ μ½κΈ°/μ“°κΈ° κ΄€λ¦¬
- **Emitter Isolation**: μ—λ―Έν„° κ°„ λ…λ¦½μ μΈ μ‹λ®¬λ μ΄μ…

**3-tier μ•„ν‚¤ν…μ²:**

```
FNiagaraSystemSimulation (λ°°μΉ μ‹λ®¬λ μ΄μ… λ§¤λ‹μ €)
      β”β”€ λ™μΌ UNiagaraSystemμ λ¨λ“  μΈμ¤ν„΄μ¤ κ΄€λ¦¬
      β”β”€ System-level Spawn/Update Script μ‹¤ν–‰
      β””β”€ DataSet λ°°μΉ μ²λ¦¬
         β”‚
         β”β”€ FNiagaraSystemInstance #1 (κ°λ³„ μ‹μ¤ν… μΈμ¤ν„΄μ¤)
         β”‚   β”β”€ World, Transform, Age λ“± μΈμ¤ν„΄μ¤ μƒνƒ
         β”‚   β”β”€ ParameterStore (μΈμ¤ν„΄μ¤λ³„ νλΌλ―Έν„°)
         β”‚   β””β”€ FNiagaraEmitterInstance[] (μ—λ―Έν„° λ©λ΅)
         β”‚       β”β”€ Emitter #1 (κ°λ³„ μ—λ―Έν„° μΈμ¤ν„΄μ¤)
         β”‚       β”‚   β”β”€ ParticleDataSet (νν‹°ν΄ λ°μ΄ν„°)
         β”‚       β”‚   β””β”€ Spawn/Update μ‹¤ν–‰
         β”‚       β””β”€ Emitter #2
         β”‚
         β””β”€ FNiagaraSystemInstance #2
```

**π“‚ μ„μΉ:**
- `Engine/Plugins/FX/Niagara/Source/Niagara/Public/NiagaraSystemSimulation.h:248` (FNiagaraSystemSimulation)
- `Engine/Plugins/FX/Niagara/Source/Niagara/Public/NiagaraSystemInstance.h:78` (FNiagaraSystemInstance)
- `Engine/Plugins/FX/Niagara/Source/Niagara/Classes/NiagaraEmitterInstance.h:24` (FNiagaraEmitterInstance)

---

## π― μ„¤κ³„ μ² ν•™: μ™ 3-tier μ•„ν‚¤ν…μ²μΈκ°€?

### λ¬Έμ : λ‹¨μ κ°λ³„ μ‹¤ν–‰μ ν•κ³„

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    κ°λ³„ μΈμ¤ν„΄μ¤ μ‹¤ν–‰ μ‹ λ¬Έμ μ                           β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                         β”‚
β”‚  β λ¬Έμ  1: μ¤‘λ³µ μ¤ν¬λ¦½νΈ μ‹¤ν–‰                                           β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  λ™μΌν• SystemSpawnScriptλ¥Ό μΈμ¤ν„΄μ¤λ§λ‹¤ λ³„λ„ μ‹¤ν–‰       β”‚          β”‚
β”‚  β”‚  - 100κ° μΈμ¤ν„΄μ¤ β†’ 100λ² λ™μΌ μ¤ν¬λ¦½νΈ μ‹¤ν–‰            β”‚          β”‚
β”‚  β”‚  - μ¤‘λ³µ λ°”μΈλ”©, μ¤‘λ³µ DataInterface μ΄κΈ°ν™”               β”‚          β”‚
β”‚  β”‚  β†’ λ¶ν•„μ”ν• CPU μ‹κ°„ λ‚­λΉ„                               β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  β λ¬Έμ  2: μΊμ‹ λΉ„ν¨μ¨                                                  β”‚
β”‚  - μΈμ¤ν„΄μ¤λ³„λ΅ λ‹¤λ¥Έ λ©”λ¨λ¦¬ μ£Όμ† μ ‘κ·Ό                                    β”‚
β”‚  - CPU μΊμ‹ λ―Έμ¤ λΉλ²                                                   β”‚
β”‚  - νμ΄ν”„λΌμΈ μ¤ν†¨ (Pipeline Stall)                                     β”‚
β”‚                                                                         β”‚
β”‚  β λ¬Έμ  3: λ³‘λ ¬ν™” μ–΄λ ¤μ›€                                                β”‚
β”‚  - μΈμ¤ν„΄μ¤ κ°„ λ…λ¦½μ„± λ³΄μ¥ μ–΄λ ¤μ›€                                        β”‚
β”‚  - λ™κΈ°ν™” μ¤λ²„ν—¤λ“ μ¦κ°€                                                 β”‚
β”‚  - μ¤λ λ“ ν’€ ν™μ© μ ν•μ                                                 β”‚
β”‚                                                                         β”‚
β”‚  β λ¬Έμ  4: λ©”λ¨λ¦¬ ννΈν™”                                                β”‚
β”‚  - μΈμ¤ν„΄μ¤λ§λ‹¤ λ¶„μ‚°λ ν• λ‹Ή                                              β”‚
β”‚  - λ©”λ¨λ¦¬ λ€μ—­ν­ λ‚­λΉ„                                                   β”‚
β”‚  - νμ΄μ§€ ν΄νΈ μ¦κ°€                                                     β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                            β†“
                   3-tier μ•„ν‚¤ν…μ² μ†”λ£¨μ…:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                                                                         β”‚
β”‚  β… ν•΄κ²° 1: λ°°μΉ μ‹λ®¬λ μ΄μ… (Batch Simulation)                          β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  FNiagaraSystemSimulation                               β”‚          β”‚
β”‚  β”‚  β””β”€ λ™μΌ UNiagaraSystemμ λ¨λ“  μΈμ¤ν„΄μ¤ λ°°μΉλ΅ λ¬¶μ    β”‚          β”‚
β”‚  β”‚      β”β”€ SystemSpawnScript 1νλ§ μ‹¤ν–‰ (κ³µμ )            β”‚          β”‚
β”‚  β”‚      β”β”€ SystemUpdateScript λ°°μΉλ΅ μ‹¤ν–‰                  β”‚          β”‚
β”‚  β”‚      β””β”€ DataSet λ°°μΉ μ²λ¦¬                               β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  μ΄μ :                                                   β”‚          β”‚
β”‚  β”‚  - 100κ° μΈμ¤ν„΄μ¤ β†’ 1κ° λ°°μΉ μ‹λ®¬λ μ΄μ…                 β”‚          β”‚
β”‚  β”‚  - μ¤ν¬λ¦½νΈ λ°”μΈλ”© μ¬μ‚¬μ©                               β”‚          β”‚
β”‚  β”‚  - μΊμ‹ ννΈμ¨ ν–¥μƒ                                     β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  β… ν•΄κ²° 2: SOA (Structure of Arrays) λ μ΄μ•„μ›ƒ                          β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  AOS (Array of Structures) - λλ¦Ό:                      β”‚          β”‚
β”‚  β”‚  struct Particle { float X, Y, Z; };                    β”‚          β”‚
β”‚  β”‚  Particle Particles[1000];                              β”‚          β”‚
β”‚  β”‚  β†’ μΊμ‹ λΌμΈμ— X, Y, Z μ„μ„ (λΉ„ν¨μ¨)                    β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  SOA (Structure of Arrays) - λΉ λ¦„:                      β”‚          β”‚
β”‚  β”‚  float PositionX[1000];                                 β”‚          β”‚
β”‚  β”‚  float PositionY[1000];                                 β”‚          β”‚
β”‚  β”‚  float PositionZ[1000];                                 β”‚          β”‚
β”‚  β”‚  β†’ SIMD λ΅λ“ μµμ ν™” (4κ°μ”© λ³‘λ ¬ μ²λ¦¬)                   β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  μ„±λ¥ ν–¥μƒ:                                              β”‚          β”‚
β”‚  β”‚  - SSE/AVX λ…λ Ήμ–΄ ν™μ©                                  β”‚          β”‚
β”‚  β”‚  - μΊμ‹ λΌμΈ ν™μ©λ¥  4λ°° ν–¥μƒ                            β”‚          β”‚
β”‚  β”‚  - λ©”λ¨λ¦¬ λ€μ—­ν­ ν¨μ¨ κ·Ήλ€ν™”                            β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  β… ν•΄κ²° 3: Concurrent Tick (λ³‘λ ¬ μ‹¤ν–‰)                                 β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  Tick νλ¦„:                                              β”‚          β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚          β”‚
β”‚  β”‚  β”‚ GameThread                                       β”‚   β”‚          β”‚
β”‚  β”‚  β”‚  β””β”€ Tick_GameThread()                           β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ νλΌλ―Έν„° μ—…λ°μ΄νΈ                        β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ DataInterface μ—…λ°μ΄νΈ                   β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β””β”€ Concurrent μ‘μ—… μ‹μ‘ β”€β”                 β”‚   β”‚          β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚          β”‚
β”‚  β”‚                                  β†“                       β”‚          β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚          β”‚
β”‚  β”‚  β”‚ Concurrent Thread (λ³‘λ ¬)                        β”‚   β”‚          β”‚
β”‚  β”‚  β”‚  β””β”€ Tick_Concurrent()                           β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ SpawnScripts μ‹¤ν–‰ (CPU/GPU)             β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ UpdateScripts μ‹¤ν–‰                      β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ νν‹°ν΄ λ°μ΄ν„° μ—…λ°μ΄νΈ                   β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β””β”€ Bounds κ³„μ‚° β”€β”                          β”‚   β”‚          β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚          β”‚
β”‚  β”‚                          β†“                               β”‚          β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚          β”‚
β”‚  β”‚  β”‚ GameThread (λ™κΈ°ν™”)                              β”‚   β”‚          β”‚
β”‚  β”‚  β”‚  β””β”€ FinalizeTick_GameThread()                   β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ λ λ”λ§ λ°μ΄ν„° μ¤€λΉ„                       β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β”β”€ μ΄λ²¤νΈ λ°μƒ μ²λ¦¬                         β”‚   β”‚          β”‚
β”‚  β”‚  β”‚      β””β”€ μƒνƒ μ—…λ°μ΄νΈ                            β”‚   β”‚          β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  μ΄μ :                                                   β”‚          β”‚
β”‚  β”‚  - λ©€ν‹°μ½”μ–΄ CPU ν™μ©                                     β”‚          β”‚
β”‚  β”‚  - ν”„λ μ„ μ‹κ°„ λ‹¨μ¶•                                     β”‚          β”‚
β”‚  β”‚  - λ©”μΈ μ¤λ λ“ λ¶€λ‹΄ κ°μ†                                β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  β… ν•΄κ²° 4: Emitter Isolation (μ—λ―Έν„° κ²©λ¦¬)                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  FNiagaraSystemInstance                                 β”‚          β”‚
β”‚  β”‚  β””β”€ TArray<FNiagaraEmitterInstance>                     β”‚          β”‚
β”‚  β”‚      β”β”€ Emitter A: CPU Simulation                       β”‚          β”‚
β”‚  β”‚      β”β”€ Emitter B: GPU Simulation                       β”‚          β”‚
β”‚  β”‚      β””β”€ Emitter C: Disabled                             β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  κ° μ—λ―Έν„°λ” λ…λ¦½μ μΌλ΅:                                 β”‚          β”‚
β”‚  β”‚  - μμ²΄ ParticleDataSet λ³΄μ                             β”‚          β”‚
β”‚  β”‚  - μμ²΄ Spawn/Update Script μ‹¤ν–‰                        β”‚          β”‚
β”‚  β”‚  - μμ²΄ Renderer λ³΄μ                                    β”‚          β”‚
β”‚  β”‚  β†’ μ—λ―Έν„° κ°„ μν–¥ μ—†μ, λ³‘λ ¬ μ‹¤ν–‰ κ°€λ¥                  β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  β… ν•΄κ²° 5: CPU/GPU μλ™ λ¶„κΈ°                                           β”‚
β”‚  - SimTargetμ— λ”°λΌ μ‹¤ν–‰ κ²½λ΅ μλ™ μ „ν™                                  β”‚
β”‚  - CPU: VectorVM::Exec() νΈμ¶                                           β”‚
β”‚  - GPU: Compute Dispatch νμ— λ“±λ΅                                      β”‚
β”‚  - νΌν•©: CPU/GPU μ—λ―Έν„° λ³‘λ ¬ μ‹¤ν–‰                                        β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μ„¤κ³„ κ²°μ •

| κ²°μ • μ‚¬ν•­ | μ΄μ  | νΈλ μ΄λ“μ¤ν”„ |
|----------|------|-------------|
| **λ°°μΉ μ‹λ®¬λ μ΄μ…** | λ™μΌ μ‹μ¤ν… λ¬¶μ–΄ ν¨μ¨ κ·Ήλ€ν™” | λ‹¤λ¥Έ μ‹μ¤ν… κ°„ λ°°μΉ­ λ¶κ°€ |
| **3-tier κµ¬μ΅°** | μ±…μ„ λ¶„λ¦¬, ν™•μ¥μ„± | κ°„μ ‘ μ ‘κ·Ό μ¤λ²„ν—¤λ“ |
| **SOA λ μ΄μ•„μ›ƒ** | SIMD μµμ ν™”, μΊμ‹ ν¨μ¨ | λλ¤ μ•΅μ„Έμ¤ λλ¦Ό |
| **Concurrent Tick** | λ©€ν‹°μ½”μ–΄ ν™μ©, λ³‘λ ¬ν™” | λ™κΈ°ν™” λ³µμ΅λ„ |
| **Emitter Isolation** | λ…λ¦½ μ‹¤ν–‰, μ μ—°μ„± | μ—λ―Έν„° κ°„ ν†µμ‹  μ ν• |

---

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ² (System Architecture)

### 1. FNiagaraSystemSimulation (λ°°μΉ μ‹λ®¬λ μ΄μ… λ§¤λ‹μ €)

**μ—­ν• :** λ™μΌ UNiagaraSystemμ λ¨λ“  μΈμ¤ν„΄μ¤λ¥Ό λ°°μΉλ΅ λ¬¶μ–΄ μ‹λ®¬λ μ΄μ…

**κµ¬μ΅°:**

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                   FNiagaraSystemSimulation                              β”‚
β”‚  (λ™μΌ UNiagaraSystemμ λ°°μΉ μ‹λ®¬λ μ΄μ… λ§¤λ‹μ €)                          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μ—­ν• : λ‹¤μ SystemInstanceλ¥Ό λ°°μΉλ΅ λ¬¶μ–΄ ν¨μ¨μ μΌλ΅ μ‹¤ν–‰                 β”‚
β”‚                                                                         β”‚
β”‚  Private:                                                               β”‚
β”‚    - System : UNiagaraSystem*                                          β”‚
β”‚      // μ‹λ®¬λ μ΄μ…ν•  μ‹μ¤ν… μ—μ…‹                                         β”‚
β”‚                                                                         β”‚
β”‚    - World : UWorld*                                                   β”‚
β”‚      // μ›”λ“ μ»¨ν…μ¤νΈ                                                   β”‚
β”‚                                                                         β”‚
β”‚    - SystemInstancesPerState : TArray<FNiagaraSystemInstance*>[Num]   β”‚
β”‚      // μƒνƒλ³„ μΈμ¤ν„΄μ¤ λ°°μ—΄:                                            β”‚
β”‚      //   [0] = Spawning                                               β”‚
β”‚      //   [1] = Active                                                 β”‚
β”‚      //   [2] = Inactive                                               β”‚
β”‚      //   [3] = Complete                                               β”‚
β”‚                                                                         β”‚
β”‚    - SpawnExecContext : TUniquePtr<FNiagaraScriptExecutionContextBase>β”‚
β”‚      // SystemSpawnScript μ‹¤ν–‰ μ»¨ν…μ¤νΈ                                 β”‚
β”‚                                                                         β”‚
β”‚    - UpdateExecContext : TUniquePtr<FNiagaraScriptExecutionContextBase>β”‚
β”‚      // SystemUpdateScript μ‹¤ν–‰ μ»¨ν…μ¤νΈ                                β”‚
β”‚                                                                         β”‚
β”‚    - MainDataSet : FNiagaraDataSet                                     β”‚
β”‚      // Running μƒνƒ μΈμ¤ν„΄μ¤μ λ°μ΄ν„°                                   β”‚
β”‚                                                                         β”‚
β”‚    - SpawningDataSet : FNiagaraDataSet                                 β”‚
β”‚      // Spawning μƒνƒ μΈμ¤ν„΄μ¤μ λ°μ΄ν„°                                  β”‚
β”‚                                                                         β”‚
β”‚    - PausedDataSet : FNiagaraDataSet                                   β”‚
β”‚      // Paused μƒνƒ μΈμ¤ν„΄μ¤μ λ°μ΄ν„°                                    β”‚
β”‚                                                                         β”‚
β”‚  μ£Όμ” λ©”μ„λ“:                                                            β”‚
β”‚    + Tick_GameThread(float DeltaSeconds, FGraphEventRef&) : void      β”‚
β”‚      // GameThreadμ—μ„ μ „μ²λ¦¬ λ° Concurrent μ‘μ—… μ‹μ‘                   β”‚
β”‚                                                                         β”‚
β”‚    + Tick_Concurrent(FNiagaraSystemSimulationTickContext&) : void     β”‚
β”‚      // Concurrent Threadμ—μ„ μ‹λ®¬λ μ΄μ… μ‹¤ν–‰                           β”‚
β”‚                                                                         β”‚
β”‚    + AddInstance(FNiagaraSystemInstance*) : void                       β”‚
β”‚      // μΈμ¤ν„΄μ¤ λ°°μΉμ— μ¶”κ°€                                             β”‚
β”‚                                                                         β”‚
β”‚    + RemoveInstance(FNiagaraSystemInstance*) : void                    β”‚
β”‚      // μΈμ¤ν„΄μ¤ λ°°μΉμ—μ„ μ κ±°                                           β”‚
β”‚                                                                         β”‚
β”‚    + TransferInstance(FNiagaraSystemSimulation*, FNiagaraSystemInstance*) : voidβ”‚
β”‚      // λ‹¤λ¥Έ λ°°μΉλ΅ μΈμ¤ν„΄μ¤ μ΄λ™                                        β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**π“‚ μ†μ¤ κ²€μ¦:**
- `NiagaraSystemSimulation.h:248-400` - FNiagaraSystemSimulation ν΄λμ¤

**λ°°μΉ μ‹λ®¬λ μ΄μ… λ™μ‘:**

```
UWorldμ— λ™μΌ UNiagaraSystem μΈμ¤ν„΄μ¤κ°€ λ‹¤μ μ΅΄μ¬ν•  λ•:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                                                                         β”‚
β”‚  UWorld                                                                 β”‚
β”‚  β””β”€ NiagaraWorldManager                                                β”‚
β”‚      β””β”€ SystemSimulations (Map<UNiagaraSystem*, FNiagaraSystemSimulation>)β”‚
β”‚          β”‚                                                              β”‚
β”‚          β”β”€ ExplosionSystem β†’ FNiagaraSystemSimulation #1              β”‚
β”‚          β”‚   β””β”€ SystemInstances[] (ExplosionSystem μΈμ¤ν„΄μ¤λ“¤)          β”‚
β”‚          β”‚       β”β”€ Instance #1 (μ„μΉ: (100, 200, 0))                  β”‚
β”‚          β”‚       β”β”€ Instance #2 (μ„μΉ: (150, 250, 10))                 β”‚
β”‚          β”‚       β”β”€ Instance #3 (μ„μΉ: (200, 300, 5))                  β”‚
β”‚          β”‚       β””β”€ ... (100κ° μΈμ¤ν„΄μ¤)                                β”‚
β”‚          β”‚                                                              β”‚
β”‚          β”β”€ FireSystem β†’ FNiagaraSystemSimulation #2                   β”‚
β”‚          β”‚   β””β”€ SystemInstances[] (FireSystem μΈμ¤ν„΄μ¤λ“¤)               β”‚
β”‚          β”‚       β”β”€ Instance #1                                        β”‚
β”‚          β”‚       β””β”€ Instance #2                                        β”‚
β”‚          β”‚                                                              β”‚
β”‚          β””β”€ SmokeSystem β†’ FNiagaraSystemSimulation #3                  β”‚
β”‚              β””β”€ SystemInstances[] (SmokeSystem μΈμ¤ν„΄μ¤λ“¤)              β”‚
β”‚                                                                         β”‚
β”‚  λ§¤ ν”„λ μ„ Tick:                                                         β”‚
β”‚  NiagaraWorldManager::Tick(DeltaTime)                                  β”‚
β”‚  β””β”€ for each SystemSimulation:                                         β”‚
β”‚      β””β”€ Simulation->Tick_GameThread(DeltaTime)                         β”‚
β”‚          β””β”€ 100κ° ExplosionSystem μΈμ¤ν„΄μ¤λ¥Ό λ°°μΉλ΅ μ‹¤ν–‰                β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### 2. FNiagaraSystemInstance (κ°λ³„ μ‹μ¤ν… μΈμ¤ν„΄μ¤)

**μ—­ν• :** κ°λ³„ Niagara μ‹μ¤ν…μ λ°νƒ€μ„ μΈμ¤ν„΄μ¤

**κµ¬μ΅°:**

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    FNiagaraSystemInstance                               β”‚
β”‚  (κ°λ³„ Niagara μ‹μ¤ν… μΈμ¤ν„΄μ¤)                                          β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μ—­ν• : UNiagaraSystemμ λ°νƒ€μ„ μ‹¤ν–‰ μ»¨ν…μ¤νΈ                             β”‚
β”‚                                                                         β”‚
β”‚  Private:                                                               β”‚
β”‚    - World : UWorld*                                                   β”‚
β”‚      // μ›”λ“ μ»¨ν…μ¤νΈ                                                   β”‚
β”‚                                                                         β”‚
β”‚    - System : UNiagaraSystem*                                          β”‚
β”‚      // μ‹μ¤ν… μ—μ…‹ (ν…ν”λ¦Ώ)                                             β”‚
β”‚                                                                         β”‚
β”‚    - AttachComponent : USceneComponent*                                β”‚
β”‚      // λ¶€μ°©λ μ»΄ν¬λ„νΈ (Transform λ™κΈ°ν™”)                              β”‚
β”‚                                                                         β”‚
β”‚    - SystemInstanceState : ENiagaraSystemInstanceState                 β”‚
β”‚      // None, Spawning, Active, Inactive, Complete                     β”‚
β”‚                                                                         β”‚
β”‚    - RequestedExecutionState : ENiagaraExecutionState                  β”‚
β”‚      // μ”μ²­λ μ‹¤ν–‰ μƒνƒ (Active, Inactive, Complete, Disabled)         β”‚
β”‚                                                                         β”‚
β”‚    - ActualExecutionState : ENiagaraExecutionState                     β”‚
β”‚      // μ‹¤μ  μ‹¤ν–‰ μƒνƒ                                                  β”‚
β”‚                                                                         β”‚
β”‚    - Emitters : TArray<FNiagaraEmitterInstanceRef>                     β”‚
β”‚      // μ—λ―Έν„° μΈμ¤ν„΄μ¤ λ©λ΅ (μ‹μ¤ν… λ‚΄ μ—λ―Έν„°λ“¤)                        β”‚
β”‚                                                                         β”‚
β”‚    - InstanceParameters : FNiagaraParameterStore                       β”‚
β”‚      // μΈμ¤ν„΄μ¤λ³„ νλΌλ―Έν„° μ¤ν† μ–΄                                       β”‚
β”‚                                                                         β”‚
β”‚    - OverrideParameters : FNiagaraUserRedirectionParameterStore*       β”‚
β”‚      // Componentμ—μ„ μ „λ‹¬λ μ¤λ²„λΌμ΄λ“ νλΌλ―Έν„°                         β”‚
β”‚                                                                         β”‚
β”‚    - DataInterfaceInstanceData : TArray<uint8>                         β”‚
β”‚      // DataInterfaceλ³„ Per-Instance λ°μ΄ν„°                             β”‚
β”‚                                                                         β”‚
β”‚    - Age : float                                                       β”‚
β”‚      // μ‹μ¤ν… Age (κ²½κ³Ό μ‹κ°„)                                          β”‚
β”‚                                                                         β”‚
β”‚    - TickCount : int32                                                 β”‚
β”‚      // Tick μΉ΄μ΄νΈ                                                     β”‚
β”‚                                                                         β”‚
β”‚    - WorldTransform : FTransform                                       β”‚
β”‚      // μ›”λ“ κ³µκ°„ Transform                                             β”‚
β”‚                                                                         β”‚
β”‚    - LWCTile : FVector3f                                               β”‚
β”‚      // Large World Coordinates νƒ€μΌ                                   β”‚
β”‚                                                                         β”‚
β”‚  μ£Όμ” λ©”μ„λ“:                                                            β”‚
β”‚    + Tick_GameThread(float DeltaSeconds) : void                        β”‚
β”‚      // GameThread μ „μ²λ¦¬                                               β”‚
β”‚                                                                         β”‚
β”‚    + Tick_Concurrent(bool bEnqueueGPUTick) : void                      β”‚
β”‚      // Concurrent Thread μ‹λ®¬λ μ΄μ…                                    β”‚
β”‚                                                                         β”‚
β”‚    + FinalizeTick_GameThread(bool bEnqueueGPUTick) : void              β”‚
β”‚      // GameThread ν›„μ²λ¦¬                                               β”‚
β”‚                                                                         β”‚
β”‚    + Activate() : void                                                 β”‚
β”‚      // μ‹μ¤ν… ν™μ„±ν™”                                                   β”‚
β”‚                                                                         β”‚
β”‚    + Deactivate() : void                                               β”‚
β”‚      // μ‹μ¤ν… λΉ„ν™μ„±ν™”                                                 β”‚
β”‚                                                                         β”‚
β”‚    + Complete() : void                                                 β”‚
β”‚      // μ‹μ¤ν… μ™„λ£                                                     β”‚
β”‚                                                                         β”‚
β”‚    + SetPaused(bool bPaused) : void                                    β”‚
β”‚      // μΌμ‹μ •μ§€ μ„¤μ •                                                   β”‚
β”‚                                                                         β”‚
β”‚    + GetSystemSimulation() : FNiagaraSystemSimulation*                 β”‚
β”‚      // μ†μ† λ°°μΉ μ‹λ®¬λ μ΄μ… λ°ν™                                        β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**π“‚ μ†μ¤ κ²€μ¦:**
- `NiagaraSystemInstance.h:78-500` - FNiagaraSystemInstance ν΄λμ¤

### 3. FNiagaraEmitterInstance (κ°λ³„ μ—λ―Έν„° μΈμ¤ν„΄μ¤)

**μ—­ν• :** κ°λ³„ μ—λ―Έν„°μ λ°νƒ€μ„ μΈμ¤ν„΄μ¤ (νν‹°ν΄ μ†μ )

**κµ¬μ΅°:**

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                   FNiagaraEmitterInstance                               β”‚
β”‚  (κ°λ³„ μ—λ―Έν„° μΈμ¤ν„΄μ¤ - νν‹°ν΄ λ³΄μ )                                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μ—­ν• : μ—λ―Έν„°μ νν‹°ν΄ μ‹λ®¬λ μ΄μ… μ‹¤ν–‰                                    β”‚
β”‚                                                                         β”‚
β”‚  Protected:                                                             β”‚
β”‚    - ParentSystemInstance : FNiagaraSystemInstance*                    β”‚
β”‚      // λ¶€λ¨ μ‹μ¤ν… μΈμ¤ν„΄μ¤                                             β”‚
β”‚                                                                         β”‚
β”‚    - ParticleDataSet : FNiagaraDataSet*                                β”‚
β”‚      // νν‹°ν΄ λ°μ΄ν„° (SOA λ μ΄μ•„μ›ƒ)                                     β”‚
β”‚                                                                         β”‚
β”‚    - GPUExecContext : FNiagaraComputeExecutionContext*                 β”‚
β”‚      // GPU μ‹¤ν–‰ μ»¨ν…μ¤νΈ (GPU μ‹λ®¬λ μ΄μ… μ‹)                           β”‚
β”‚                                                                         β”‚
β”‚    - GPUDataBufferInterfaces : INiagaraComputeDataBufferInterface*     β”‚
β”‚      // GPU λ°μ΄ν„° λ²„νΌ μΈν„°νμ΄μ¤                                       β”‚
β”‚                                                                         β”‚
β”‚    - VersionedEmitter : FVersionedNiagaraEmitter                       β”‚
β”‚      // μ—λ―Έν„° μ—μ…‹ λ° λ²„μ „                                              β”‚
β”‚                                                                         β”‚
β”‚    - RendererBindings : FNiagaraParameterStore                         β”‚
β”‚      // λ λ”λ¬ λ°”μΈλ”© νλΌλ―Έν„°                                           β”‚
β”‚                                                                         β”‚
β”‚    - EmitterIndex : int32                                              β”‚
β”‚      // μ‹μ¤ν… λ‚΄ μ—λ―Έν„° μΈλ±μ¤                                          β”‚
β”‚                                                                         β”‚
β”‚    - TotalSpawnedParticles : int32                                     β”‚
β”‚      // μ΄ μƒμ„±λ νν‹°ν΄ κ°μ (λ„μ )                                     β”‚
β”‚                                                                         β”‚
β”‚    - bLocalSpace : bool                                                β”‚
β”‚      // Local Space μ‹λ®¬λ μ΄μ… μ—¬λ¶€                                     β”‚
β”‚                                                                         β”‚
β”‚    - bDeterministic : bool                                             β”‚
β”‚      // Deterministic μ‹λ®¬λ μ΄μ… μ—¬λ¶€                                   β”‚
β”‚                                                                         β”‚
β”‚    - SimTarget : ENiagaraSimTarget                                     β”‚
β”‚      // CPUSim, GPUComputeSim                                          β”‚
β”‚                                                                         β”‚
β”‚    - ExecutionState : ENiagaraExecutionState                           β”‚
β”‚      // Active, Inactive, Complete, Disabled                           β”‚
β”‚                                                                         β”‚
β”‚    - CachedBounds : FBox                                               β”‚
β”‚      // μΊμ‹λ κ²½κ³„ (Bounds)                                            β”‚
β”‚                                                                         β”‚
β”‚    - FixedBounds : FBox                                                β”‚
β”‚      // κ³ μ • κ²½κ³„ (Fixed Bounds)                                        β”‚
β”‚                                                                         β”‚
β”‚  μ£Όμ” λ©”μ„λ“:                                                            β”‚
β”‚    + Init(int32 EmitterIdx) : void                                     β”‚
β”‚      // μ΄κΈ°ν™”                                                          β”‚
β”‚                                                                         β”‚
β”‚    + ResetSimulation(bool bKillExisting) : void (virtual)              β”‚
β”‚      // μ‹λ®¬λ μ΄μ… λ¦¬μ…‹                                                  β”‚
β”‚                                                                         β”‚
β”‚    + Tick(float DeltaSeconds) : void (virtual)                         β”‚
β”‚      // μ—λ―Έν„° Tick (Spawn/Update Script μ‹¤ν–‰)                          β”‚
β”‚                                                                         β”‚
β”‚    + GetNumParticles() : int32 (virtual)                               β”‚
β”‚      // ν„μ¬ νν‹°ν΄ κ°μ λ°ν™                                            β”‚
β”‚                                                                         β”‚
β”‚    + GetParticleData() : FNiagaraDataSet&                              β”‚
β”‚      // νν‹°ν΄ DataSet λ°ν™                                             β”‚
β”‚                                                                         β”‚
β”‚    + GetGPUContext() : FNiagaraComputeExecutionContext*                β”‚
β”‚      // GPU μ‹¤ν–‰ μ»¨ν…μ¤νΈ λ°ν™                                           β”‚
β”‚                                                                         β”‚
β”‚    + GetBounds() : FBox                                                β”‚
β”‚      // κ²½κ³„ λ°ν™                                                       β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**π“‚ μ†μ¤ κ²€μ¦:**
- `NiagaraEmitterInstance.h:24-243` - FNiagaraEmitterInstance ν΄λμ¤

---

## π”„ Tick νλ¦„ (Tick Flow)

### μ „μ²΄ Tick νλ¦„

```
λ§¤ ν”„λ μ„:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     Niagara Simulation Tick Flow                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                                         β”‚
β”‚  [1] UWorld::Tick(DeltaTime)                                           β”‚
β”‚  β””β”€ FNiagaraWorldManager::Tick(DeltaTime)                              β”‚
β”‚      β””β”€ for each FNiagaraSystemSimulation:                             β”‚
β”‚          β””β”€ SystemSimulation->Tick_GameThread(DeltaTime, CompletionEvent)β”‚
β”‚              β”‚                                                          β”‚
β”‚              β”β”€ [1-1] μΈμ¤ν„΄μ¤ μƒνƒ μ—…λ°μ΄νΈ                            β”‚
β”‚              β”‚   β””β”€ for each SystemInstance:                           β”‚
β”‚              β”‚       β”β”€ Instance->Tick_GameThread(DeltaTime)           β”‚
β”‚              β”‚       β”‚   β”β”€ Age += DeltaTime                           β”‚
β”‚              β”‚       β”‚   β”β”€ Transform λ™κΈ°ν™” (AttachComponent)         β”‚
β”‚              β”‚       β”‚   β”β”€ ParameterStore μ—…λ°μ΄νΈ                    β”‚
β”‚              β”‚       β”‚   β””β”€ DataInterface->PerInstanceTick()           β”‚
β”‚              β”‚       β”‚                                                  β”‚
β”‚              β”‚       β””β”€ μƒνƒλ³„ λ°°μ—΄μ— μ¶”κ°€ (Active, Inactive λ“±)        β”‚
β”‚              β”‚                                                          β”‚
β”‚              β”β”€ [1-2] Concurrent μ‘μ—… μ¤€λΉ„                             β”‚
β”‚              β”‚   β”β”€ DataSet λ²„νΌ μ¤μ™€ν•‘                                β”‚
β”‚              β”‚   β”β”€ μ¤ν¬λ¦½νΈ λ°”μΈλ”© κ°±μ‹                                β”‚
β”‚              β”‚   β””β”€ GPU Dispatch μ¤€λΉ„                                  β”‚
β”‚              β”‚                                                          β”‚
β”‚              β””β”€ [1-3] Concurrent μ‘μ—… μ‹μ‘ (λΉ„λ™κΈ°)                    β”‚
β”‚                  β””β”€ TaskGraph::DispatchTask(Tick_Concurrent, ...)     β”‚
β”‚                      β””β”€ CompletionEvent λ“±λ΅                           β”‚
β”‚                                                                         β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”β”‚
β”‚  β”‚                  [2] Concurrent Thread (λ³‘λ ¬ μ‹¤ν–‰)                 β”‚β”‚
β”‚  β”‚  SystemSimulation->Tick_Concurrent(TickContext)                   β”‚β”‚
β”‚  β”‚  β”‚                                                                 β”‚β”‚
β”‚  β”‚  β”β”€ [2-1] System-Level Scripts μ‹¤ν–‰                               β”‚β”‚
β”‚  β”‚  β”‚   β”β”€ SystemSpawnScript μ‹¤ν–‰ (μƒ μΈμ¤ν„΄μ¤)                      β”‚β”‚
β”‚  β”‚  β”‚   β””β”€ SystemUpdateScript μ‹¤ν–‰ (λ¨λ“  μΈμ¤ν„΄μ¤ λ°°μΉ)              β”‚β”‚
β”‚  β”‚  β”‚                                                                 β”‚β”‚
β”‚  β”‚  β”β”€ [2-2] Emitter-Level Tick                                      β”‚β”‚
β”‚  β”‚  β”‚   β””β”€ for each SystemInstance:                                  β”‚β”‚
β”‚  β”‚  β”‚       β””β”€ Instance->Tick_Concurrent()                           β”‚β”‚
β”‚  β”‚  β”‚           β””β”€ for each EmitterInstance:                         β”‚β”‚
β”‚  β”‚  β”‚               β”β”€ EmitterSpawnScript μ‹¤ν–‰                        β”‚β”‚
β”‚  β”‚  β”‚               β”β”€ EmitterUpdateScript μ‹¤ν–‰                       β”‚β”‚
β”‚  β”‚  β”‚               β”‚                                                 β”‚β”‚
β”‚  β”‚  β”‚               β”β”€ [2-2-1] CPU μ‹λ®¬λ μ΄μ… (CPUSim)               β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β”β”€ ParticleSpawnScript μ‹¤ν–‰                   β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β”‚   β””β”€ VectorVM::Exec(SpawnContext)          β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β”β”€ ParticleUpdateScript μ‹¤ν–‰                  β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β”‚   β””β”€ VectorVM::Exec(UpdateContext)         β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β””β”€ EventScripts μ‹¤ν–‰                          β”‚β”‚
β”‚  β”‚  β”‚               β”‚                                                 β”‚β”‚
β”‚  β”‚  β”‚               β”β”€ [2-2-2] GPU μ‹λ®¬λ μ΄μ… (GPUComputeSim)        β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β”β”€ GPU Dispatch νμ— λ“±λ΅                     β”‚β”‚
β”‚  β”‚  β”‚               β”‚   β””β”€ GPU λ²„νΌ μ—…λ°μ΄νΈ                          β”‚β”‚
β”‚  β”‚  β”‚               β”‚                                                 β”‚β”‚
β”‚  β”‚  β”‚               β”β”€ Bounds κ³„μ‚° (Dynamic Bounds)                  β”‚β”‚
β”‚  β”‚  β”‚               β””β”€ μ΄λ²¤νΈ μƒμ„± (Collision, Death λ“±)              β”‚β”‚
β”‚  β”‚  β”‚                                                                 β”‚β”‚
β”‚  β”‚  β””β”€ [2-3] GPU Tick λ°ν–‰ (GPUComputeSim)                           β”‚β”‚
β”‚  β”‚      β””β”€ NiagaraGPUSystemTick νμ— λ“±λ΅                            β”‚β”‚
β”‚  β”‚          β””β”€ RenderThreadμ—μ„ Compute Shader μ‹¤ν–‰                  β”‚β”‚
β”‚  β”‚                                                                     β”‚β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”β”‚
β”‚         β”‚                                                               β”‚
β”‚         β†“ CompletionEvent λ€κΈ°                                         β”‚
β”‚  [3] FinalizeTick_GameThread() (λ©”μΈ μ¤λ λ“ λ³µκ·€)                      β”‚
β”‚  β””β”€ for each SystemInstance:                                           β”‚
β”‚      β””β”€ Instance->FinalizeTick_GameThread()                            β”‚
β”‚          β”β”€ [3-1] λ λ”λ§ λ°μ΄ν„° μ¤€λΉ„                                    β”‚
β”‚          β”‚   β”β”€ Dynamic Mesh λ°μ΄ν„° μ—…λ°μ΄νΈ                           β”‚
β”‚          β”‚   β”β”€ Sprite Renderer λ°μ΄ν„° μ—…λ°μ΄νΈ                        β”‚
β”‚          β”‚   β””β”€ Bounds μµμΆ… ν™•μ •                                       β”‚
β”‚          β”‚                                                              β”‚
β”‚          β”β”€ [3-2] μ΄λ²¤νΈ μ²λ¦¬                                           β”‚
β”‚          β”‚   β”β”€ Death Events β†’ μƒ νν‹°ν΄ μ¤ν°                          β”‚
β”‚          β”‚   β””β”€ Collision Events β†’ μ‚¬μ΄λ“ μ¬μƒ                         β”‚
β”‚          β”‚                                                              β”‚
β”‚          β”β”€ [3-3] μƒνƒ μ—…λ°μ΄νΈ                                         β”‚
β”‚          β”‚   β”β”€ Complete μ²΄ν¬                                          β”‚
β”‚          β”‚   β””β”€ Auto Destroy μ²΄ν¬                                      β”‚
β”‚          β”‚                                                              β”‚
β”‚          β””β”€ [3-4] Scalability μ²΄ν¬                                     β”‚
β”‚              β””β”€ Culling μ—¬λ¶€ νλ‹¨                                      β”‚
β”‚                                                                         β”‚
β”‚  [4] GPU Tick μ‹¤ν–‰ (RenderThread - λΉ„λ™κΈ°)                             β”‚
β”‚  β””β”€ NiagaraGPUComputeDispatchInterface::Tick()                        β”‚
β”‚      β””β”€ for each GPUTick:                                              β”‚
β”‚          β”β”€ Compute Shader Dispatch                                    β”‚
β”‚          β”‚   β”β”€ ParticleSpawnCS μ‹¤ν–‰                                   β”‚
β”‚          β”‚   β”β”€ ParticleUpdateCS μ‹¤ν–‰                                  β”‚
β”‚          β”‚   β””β”€ SimulationStageCS μ‹¤ν–‰                                 β”‚
β”‚          β”β”€ GPU λ²„νΌ μ½κΈ°/μ“°κΈ°                                          β”‚
β”‚          β””β”€ GPU μ΄λ²¤νΈ μ²λ¦¬                                             β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μ„±λ¥ μµμ ν™” ν¬μΈνΈ

```
Tick νλ¦„λ³„ μµμ ν™”:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                                                                         β”‚
β”‚  [1] GameThread μ „μ²λ¦¬ (λ©ν‘: <1ms)                                     β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  μµμ ν™”:                                                 β”‚          β”‚
β”‚  β”‚  - Transform λ™κΈ°ν™”: λ³€κ²½ κ°μ§€ (Dirty Flag)              β”‚          β”‚
β”‚  β”‚  - ParameterStore: λ³€κ²½λ νλΌλ―Έν„°λ§ μ—…λ°μ΄νΈ            β”‚          β”‚
β”‚  β”‚  - DataInterface: PerInstanceTick μµμ†ν™”                β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  β ν”Όν•΄μ•Ό ν•  κ²ƒ:                                        β”‚          β”‚
β”‚  β”‚  - λ¬΄κ±°μ΄ κ³„μ‚° (Concurrentλ΅ μ΄λ™)                      β”‚          β”‚
β”‚  β”‚  - λ™κΈ° νμΌ I/O                                        β”‚          β”‚
β”‚  β”‚  - κΈ΄ λ£¨ν”„ (λ°°μΉλ΅ μ΄λ™)                                β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  [2] Concurrent Thread (λ©ν‘: <5ms, λ³‘λ ¬)                               β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  μµμ ν™”:                                                 β”‚          β”‚
β”‚  β”‚  - SIMD λ…λ Ήμ–΄ ν™μ© (VectorVM)                           β”‚          β”‚
β”‚  β”‚  - SOA λ°μ΄ν„° λ μ΄μ•„μ›ƒ                                   β”‚          β”‚
β”‚  β”‚  - λ°°μΉ μ²λ¦¬ (λ™μΌ μ‹μ¤ν… λ¬¶μ)                         β”‚          β”‚
β”‚  β”‚  - GPU Dispatch μ¤€λΉ„λ§ (μ‹¤ν–‰ X)                         β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  μ„±λ¥:                                                   β”‚          β”‚
β”‚  β”‚  - 10k νν‹°ν΄ (CPU): ~0.5ms                             β”‚          β”‚
β”‚  β”‚  - 100k νν‹°ν΄ (CPU): ~5ms                              β”‚          β”‚
β”‚  β”‚  - λ©€ν‹°μ½”μ–΄ ν™μ©μΌλ΅ λ¶„μ‚° κ°€λ¥                           β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  [3] GameThread ν›„μ²λ¦¬ (λ©ν‘: <0.5ms)                                   β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  μµμ ν™”:                                                 β”‚          β”‚
β”‚  β”‚  - λ λ”λ§ λ°μ΄ν„°λ§ μ—…λ°μ΄νΈ (μµμ†ν™”)                     β”‚          β”‚
β”‚  β”‚  - μ΄λ²¤νΈ μ²λ¦¬: νλ΅ κ΄€λ¦¬ (μ¦‰μ‹ μ‹¤ν–‰ X)                 β”‚          β”‚
β”‚  β”‚  - Bounds: μ΄μ „ ν”„λ μ„ μ¬μ‚¬μ© (λ³€κ²½ μ‹λ§)               β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β”‚  [4] GPU Tick (λ©ν‘: <2ms, RenderThread)                               β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚  β”‚  μµμ ν™”:                                                 β”‚          β”‚
β”‚  β”‚  - Compute Shader μµμ ν™”                                β”‚          β”‚
β”‚  β”‚  - Occupancy κ·Ήλ€ν™” (Thread Group ν¬κΈ°)                 β”‚          β”‚
β”‚  β”‚  - λ©”λ¨λ¦¬ λ€μ—­ν­ μµμ†ν™”                                  β”‚          β”‚
β”‚  β”‚                                                          β”‚          β”‚
β”‚  β”‚  μ„±λ¥:                                                   β”‚          β”‚
β”‚  β”‚  - 100k νν‹°ν΄ (GPU): ~0.5ms                            β”‚          β”‚
β”‚  β”‚  - 1M νν‹°ν΄ (GPU): ~4ms                                β”‚          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## π“¦ DataSet λ° SOA λ μ΄μ•„μ›ƒ

### FNiagaraDataSet κµ¬μ΅°

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                      FNiagaraDataSet                                    β”‚
β”‚  (νν‹°ν΄ λ°μ΄ν„° μ €μ¥μ† - SOA λ μ΄μ•„μ›ƒ)                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μ—­ν• : νν‹°ν΄ μ†μ„±μ„ SOAλ΅ μ €μ¥ν•μ—¬ SIMD μµμ ν™”                          β”‚
β”‚                                                                         β”‚
β”‚  κµ¬μ΅°:                                                                   β”‚
β”‚    - Variables : TArray<FNiagaraVariable>                              β”‚
β”‚      // μ €μ¥ν•  μ†μ„± λ©λ΅:                                                β”‚
β”‚      //   Particles.Position (Vector3)                                 β”‚
β”‚      //   Particles.Velocity (Vector3)                                 β”‚
β”‚      //   Particles.Color (Vector4)                                    β”‚
β”‚      //   Particles.Age (Float)                                        β”‚
β”‚      //   Particles.Lifetime (Float)                                   β”‚
β”‚      //   ...                                                          β”‚
β”‚                                                                         β”‚
β”‚    - Data : FNiagaraDataBuffer                                         β”‚
β”‚      // μ‹¤μ  λ°μ΄ν„° λ²„νΌ (SOA)                                           β”‚
β”‚                                                                         β”‚
β”‚    - NumInstances : int32                                              β”‚
β”‚      // ν„μ¬ νν‹°ν΄ κ°μ                                                 β”‚
β”‚                                                                         β”‚
β”‚    - MaxInstances : int32                                              β”‚
β”‚      // μµλ€ νν‹°ν΄ κ°μ                                                 β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### SOA λ μ΄μ•„μ›ƒ μƒμ„Έ

**π“‚ μ†μ¤ κ²€μ¦:**
- `NiagaraDataSet.h:212-260` - FNiagaraDataBuffer κµ¬μ΅° λ° SOA λ²„νΌ

```cpp
// NiagaraDataSet.h:212
/** Float components of simulation data. */
TArray<uint8> FloatData;
/** Int32 components of simulation data. */
TArray<uint8> Int32Data;
/** Half components of simulation data. */
TArray<uint8> HalfData;

/** Number of instances in data. */
uint32 NumInstances;
/** Number of instances the buffer has been allocated for. */
uint32 NumInstancesAllocated;
/** Stride between components in the float buffer. */
uint32 FloatStride;
/** Stride between components in the int32 buffer. */
uint32 Int32Stride;
/** Stride between components in the half buffer. */
uint32 HalfStride;
```

**λ©”λ¨λ¦¬ μ ‘κ·Ό API:**

```cpp
// NiagaraDataSet.h:129-151
// μ»΄ν¬λ„νΈλ³„ ν¬μΈν„° μ ‘κ·Ό (SOA μ‹μ‘ μ£Όμ†)
inline const uint8* GetComponentPtrFloat(uint32 ComponentIdx) const
{
    return FloatData.GetData() + FloatStride * ComponentIdx;
}

// κ°λ³„ νν‹°ν΄ μΈμ¤ν„΄μ¤ μ ‘κ·Ό
inline float* GetInstancePtrFloat(uint32 ComponentIdx, uint32 InstanceIdx)
{
    return (float*)(GetComponentPtrFloat(ComponentIdx)) + InstanceIdx;
}
```

**μ¤νΈλΌμ΄λ“ κ³„μ‚° (VECTOR_WIDTH μ •λ ¬):**

```cpp
// NiagaraDataSet.h:200
inline int32 GetSafeComponentBufferSize(int32 RequiredSize) const
{
    // Round up to VECTOR_WIDTH_BYTES (16 bytes = 4 floats)
    // - μ»΄ν¬λ„νΈ λ²„νΌλ¥Ό 16λ°”μ΄νΈ κ²½κ³„μ— μ •λ ¬
    // - SIMD λ…λ Ήμ–΄ μµμ ν™” (SSE: 4 floats, AVX: 8 floats)
    // - κ° μ»΄ν¬λ„νΈμ μ¤λ²„λ° λ°©μ§€ (+VECTOR_WIDTH_BYTES μ¶”κ°€ κ³µκ°„)
    return Align(RequiredSize, VECTOR_WIDTH_BYTES) + VECTOR_WIDTH_BYTES;
}
```

**μ‹¤μ  λ©”λ¨λ¦¬ λ μ΄μ•„μ›ƒ μμ‹ (1000 νν‹°ν΄):**

```
νν‹°ν΄ Attribute:
- Particles.Position.X (Float)
- Particles.Position.Y (Float)
- Particles.Position.Z (Float)
- Particles.Velocity.X (Float)
- Particles.Velocity.Y (Float)
- Particles.Velocity.Z (Float)
- Particles.Color.R (Float)
- Particles.Age (Float)

FloatStride κ³„μ‚°:
- 1000 νν‹°ν΄ Γ— 4 bytes/float = 4000 bytes
- Align(4000, 16) + 16 = 4000 + 16 = 4016 bytes (κ° μ»΄ν¬λ„νΈ μ¤νΈλΌμ΄λ“)

μ‹¤μ  λ©”λ¨λ¦¬:
FloatData:
[0x0000] Position.X[0..999]  (4016 bytes)
[0x0FB0] Position.Y[0..999]  (4016 bytes)
[0x1F60] Position.Z[0..999]  (4016 bytes)
[0x2F10] Velocity.X[0..999]  (4016 bytes)
[0x3EC0] Velocity.Y[0..999]  (4016 bytes)
[0x4E70] Velocity.Z[0..999]  (4016 bytes)
[0x5E20] Color.R[0..999]     (4016 bytes)
[0x6DD0] Age[0..999]         (4016 bytes)

μ΄ ν¬κΈ°: 32,128 bytes (8 μ»΄ν¬λ„νΈ Γ— 4016 bytes)
```

**GPU λ²„νΌ κµ¬μ΅°:**

```cpp
// NiagaraDataSet.h:229
/** GPU Buffer containing floating point values for GPU simulations. */
FRWBuffer GPUBufferFloat;
/** GPU Buffer containing integer values for GPU simulations. */
FRWBuffer GPUBufferInt;
/** GPU Buffer containing half values for GPU simulations. */
FRWBuffer GPUBufferHalf;
/** GPU table which maps particle ID to index. */
FRWBuffer GPUIDToIndexTable;
```

```
AOS (Array of Structures) - Unreal Engineμ΄ μ‚¬μ©ν•μ§€ μ•λ” λ°©μ‹:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  struct Particle                                                        β”‚
β”‚  {                                                                      β”‚
β”‚      FVector Position;   // 12 bytes                                   β”‚
β”‚      FVector Velocity;   // 12 bytes                                   β”‚
β”‚      FLinearColor Color; // 16 bytes                                   β”‚
β”‚      float Age;          // 4 bytes                                    β”‚
β”‚      float Lifetime;     // 4 bytes                                    β”‚
β”‚  };  // Total: 48 bytes per particle                                   β”‚
β”‚                                                                         β”‚
β”‚  Particle Particles[1000];                                             β”‚
β”‚                                                                         β”‚
β”‚  λ©”λ¨λ¦¬ λ μ΄μ•„μ›ƒ:                                                        β”‚
β”‚  [P0.Pos | P0.Vel | P0.Col | P0.Age | P0.Life]                         β”‚
β”‚  [P1.Pos | P1.Vel | P1.Col | P1.Age | P1.Life]                         β”‚
β”‚  [P2.Pos | P2.Vel | P2.Col | P2.Age | P2.Life]                         β”‚
β”‚  ...                                                                    β”‚
β”‚                                                                         β”‚
β”‚  β λ¬Έμ μ :                                                              β”‚
β”‚  - Positionλ§ μ½μΌλ ¤ ν•΄λ„ Velocity, Color λ“±μ΄ μΊμ‹μ— λ΅λ“λ¨            β”‚
β”‚  - SIMD λ…λ Ήμ–΄ μ‚¬μ© λ¶κ°€λ¥ (λ°μ΄ν„°κ°€ μ—°μ†λμ§€ μ•μ)                      β”‚
β”‚  - μΊμ‹ λΌμΈ λ‚­λΉ„ (64 bytes μΊμ‹ λΌμΈμ— 1.3κ° νν‹°ν΄λ§ λ“¤μ–΄κ°)           β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

SOA (Structure of Arrays) - Niagaraκ°€ μ‚¬μ©ν•λ” λ°©μ‹:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  FNiagaraDataBuffer                                                     β”‚
β”‚  {                                                                      β”‚
β”‚      float* PositionX;   // μ—°μ†λ λ©”λ¨λ¦¬: [P0.X, P1.X, P2.X, ...]     β”‚
β”‚      float* PositionY;   // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Y, P1.Y, P2.Y, ...]     β”‚
β”‚      float* PositionZ;   // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Z, P1.Z, P2.Z, ...]     β”‚
β”‚      float* VelocityX;   // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Vx, P1.Vx, P2.Vx, ...]  β”‚
β”‚      float* VelocityY;   // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Vy, P1.Vy, P2.Vy, ...]  β”‚
β”‚      float* VelocityZ;   // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Vz, P1.Vz, P2.Vz, ...]  β”‚
β”‚      float* ColorR;      // μ—°μ†λ λ©”λ¨λ¦¬: [P0.R, P1.R, P2.R, ...]     β”‚
β”‚      float* ColorG;      // ...                                        β”‚
β”‚      float* ColorB;      // ...                                        β”‚
β”‚      float* ColorA;      // ...                                        β”‚
β”‚      float* Age;         // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Age, P1.Age, ...]       β”‚
β”‚      float* Lifetime;    // μ—°μ†λ λ©”λ¨λ¦¬: [P0.Life, P1.Life, ...]     β”‚
β”‚  };                                                                     β”‚
β”‚                                                                         β”‚
β”‚  λ©”λ¨λ¦¬ λ μ΄μ•„μ›ƒ:                                                        β”‚
β”‚  PositionX: [P0.X | P1.X | P2.X | P3.X | P4.X | P5.X | P6.X | P7.X ...]β”‚
β”‚  PositionY: [P0.Y | P1.Y | P2.Y | P3.Y | P4.Y | P5.Y | P6.Y | P7.Y ...]β”‚
β”‚  PositionZ: [P0.Z | P1.Z | P2.Z | P3.Z | P4.Z | P5.Z | P6.Z | P7.Z ...]β”‚
β”‚  VelocityX: [P0.Vx| P1.Vx| P2.Vx| P3.Vx| P4.Vx| P5.Vx| P6.Vx| P7.Vx...]β”‚
β”‚  ...                                                                    β”‚
β”‚                                                                         β”‚
β”‚  β… μ¥μ :                                                                β”‚
β”‚  1. SIMD λ…λ Ήμ–΄ ν™μ© κ°€λ¥                                                β”‚
β”‚     - SSE: 4κ° float λ™μ‹ μ²λ¦¬ (__m128)                                β”‚
β”‚     - AVX: 8κ° float λ™μ‹ μ²λ¦¬ (__m256)                                β”‚
β”‚                                                                         β”‚
β”‚     μμ‹: Position.X μ—…λ°μ΄νΈ                                            β”‚
β”‚     for (int32 i = 0; i < NumParticles; i += 4)                        β”‚
β”‚     {                                                                   β”‚
β”‚         __m128 PosX = _mm_load_ps(&PositionX[i]);  // 4κ° λ™μ‹ λ΅λ“    β”‚
β”‚         __m128 VelX = _mm_load_ps(&VelocityX[i]);                      β”‚
β”‚         __m128 DeltaTimeVec = _mm_set1_ps(DeltaTime);                  β”‚
β”‚         __m128 Increment = _mm_mul_ps(VelX, DeltaTimeVec);             β”‚
β”‚         PosX = _mm_add_ps(PosX, Increment);                            β”‚
β”‚         _mm_store_ps(&PositionX[i], PosX);  // 4κ° λ™μ‹ μ €μ¥           β”‚
β”‚     }                                                                   β”‚
β”‚     β†’ 4λ°° λΉ λ¦„!                                                         β”‚
β”‚                                                                         β”‚
β”‚  2. μΊμ‹ ν¨μ¨ κ·Ήλ€ν™”                                                     β”‚
β”‚     - 64 bytes μΊμ‹ λΌμΈ = 16κ° float (PositionX)                       β”‚
β”‚     - μΊμ‹ ννΈμ¨ ν–¥μƒ β†’ λ©”λ¨λ¦¬ λ€μ—­ν­ μ μ•½                              β”‚
β”‚                                                                         β”‚
β”‚  3. GPU λ©”λ¨λ¦¬ μ ‘κ·Ό μµμ ν™”                                               β”‚
β”‚     - Coalesced Memory Access (λ³‘ν•© λ©”λ¨λ¦¬ μ ‘κ·Ό)                        β”‚
β”‚     - λ™μΌ μΊμ‹ λΌμΈμ—μ„ μ—¬λ¬ μ¤λ λ“κ°€ λ™μ‹ μ½κΈ°                         β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

μ„±λ¥ λΉ„κµ (10,000 νν‹°ν΄, Position μ—…λ°μ΄νΈ):
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  AOS (λΉ„μµμ ν™”):                                                         β”‚
β”‚  for (int32 i = 0; i < NumParticles; ++i)                              β”‚
β”‚  {                                                                      β”‚
β”‚      Particles[i].Position.X += Particles[i].Velocity.X * DeltaTime;   β”‚
β”‚      Particles[i].Position.Y += Particles[i].Velocity.Y * DeltaTime;   β”‚
β”‚      Particles[i].Position.Z += Particles[i].Velocity.Z * DeltaTime;   β”‚
β”‚  }                                                                      β”‚
β”‚  β†’ μΈ΅μ • μ‹κ°„: ~2.5ms (μΊμ‹ λ―Έμ¤ λΉλ²)                                    β”‚
β”‚                                                                         β”‚
β”‚  SOA (SIMD μµμ ν™”):                                                      β”‚
β”‚  for (int32 i = 0; i < NumParticles; i += 4)  // SSE                   β”‚
β”‚  {                                                                      β”‚
β”‚      __m128 PosX = _mm_load_ps(&PositionX[i]);                         β”‚
β”‚      __m128 VelX = _mm_load_ps(&VelocityX[i]);                         β”‚
β”‚      PosX = _mm_add_ps(PosX, _mm_mul_ps(VelX, DeltaTimeVec));          β”‚
β”‚      _mm_store_ps(&PositionX[i], PosX);                                β”‚
β”‚      // Y, Zλ„ λ™μΌ...                                                  β”‚
β”‚  }                                                                      β”‚
β”‚  β†’ μΈ΅μ • μ‹κ°„: ~0.4ms (6λ°° λΉ λ¦„!)                                        β”‚
β”‚                                                                         β”‚
β”‚  SOA (AVX μµμ ν™”):                                                       β”‚
β”‚  for (int32 i = 0; i < NumParticles; i += 8)  // AVX                   β”‚
β”‚  {                                                                      β”‚
β”‚      __m256 PosX = _mm256_load_ps(&PositionX[i]);                      β”‚
β”‚      __m256 VelX = _mm256_load_ps(&VelocityX[i]);                      β”‚
β”‚      PosX = _mm256_add_ps(PosX, _mm256_mul_ps(VelX, DeltaTimeVec));    β”‚
β”‚      _mm256_store_ps(&PositionX[i], PosX);                             β”‚
β”‚  }                                                                      β”‚
β”‚  β†’ μΈ΅μ • μ‹κ°„: ~0.25ms (10λ°° λΉ λ¦„!)                                      β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## π® GPU μ‹λ®¬λ μ΄μ… μƒμ„Έ (GPU Simulation Details)

### FNiagaraGPUSystemTick κµ¬μ΅°

**π“‚ μ†μ¤ κ²€μ¦:**
- `NiagaraGPUSystemTick.h:1-137` - GPU Tick κµ¬μ΅°

```cpp
// NiagaraGPUSystemTick.h (ν•µμ‹¬ κµ¬μ΅°)
class FNiagaraGPUSystemTick
{
public:
    // μΈμ¤ν„΄μ¤ λ°μ΄ν„° ν¨ν‚Ή
    uint8* InstanceData_ParamData_Packed = nullptr;
    uint8* GlobalParamData = nullptr;
    uint8* SystemParamData = nullptr;
    uint8* OwnerParamData = nullptr;

    uint32 InstanceCount = 0;          // GPUμ—μ„ μ‹¤ν–‰ν•  μΈμ¤ν„΄μ¤ κ°μ
    uint32 TotalDispatches = 0;        // μ΄ Compute Shader λ””μ¤ν¨μΉ νμ

    // ν¨ν‚Ήλ μΈμ¤ν„΄μ¤ λ°μ΄ν„° μ ‘κ·Ό
    inline TArrayView<FNiagaraComputeInstanceData> GetInstances() const
    {
        return MakeArrayView(
            reinterpret_cast<FNiagaraComputeInstanceData*>(InstanceData_ParamData_Packed),
            InstanceCount
        );
    }
};
```

**GPU Tick μƒμ„± λ° μ „μ†΅ νλ¦„:**

```
Concurrent Thread (GameThread μ‘μ—… μ™„λ£ ν›„)
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  FNiagaraSystemInstance::Tick_Concurrent()                              β”‚
β”‚  β””β”€ for each EmitterInstance (GPU μ‹λ®¬λ μ΄μ…):                          β”‚
β”‚      β””β”€ GPUExecContext->SetupParameters()                               β”‚
β”‚          β”β”€ νλΌλ―Έν„° μμ§‘ (System, Emitter, User)                       β”‚
β”‚          β”β”€ DataInterface λ°”μΈλ”© μ¤€λΉ„                                   β”‚
β”‚          β””β”€ GPU Tick λ°μ΄ν„° ν¨ν‚Ή                                        β”‚
β”‚                                                                         β”‚
β”‚  FNiagaraSystemSimulation::Tick_Concurrent()                           β”‚
β”‚  β””β”€ NiagaraGPUSystemTick μƒμ„±                                          β”‚
β”‚      β”β”€ InstanceData_ParamData_Packed ν• λ‹Ή                             β”‚
β”‚      β”β”€ λ¨λ“  Emitterμ νλΌλ―Έν„° λ³µμ‚¬                                   β”‚
β”‚      β””β”€ DispatchCount κ³„μ‚°                                             β”‚
β”‚          (ParticleSpawn, ParticleUpdate, SimulationStageλ³„)            β”‚
β”‚                                                                         β”‚
β”‚  β””β”€ GPU Tickμ„ νμ— λ“±λ΅                                                β”‚
β”‚      NiagaraGPUComputeDispatchInterface->EnqueueTick(GPUTick);         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                       β†“ RenderThreadλ΅ μ „μ†΅
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  RenderThread (λΉ„λ™κΈ° μ‹¤ν–‰)                                              β”‚
β”‚  FNiagaraGpuComputeDispatchInterface::ExecuteTicks(RDGBuilder)         β”‚
β”‚  β””β”€ for each GPUTick in Queue:                                         β”‚
β”‚      β”β”€ Compute Shader μ¤€λΉ„                                            β”‚
β”‚      β”‚   β”β”€ ParticleSpawnCS λ°”μΈλ”©                                     β”‚
β”‚      β”‚   β”β”€ ParticleUpdateCS λ°”μΈλ”©                                    β”‚
β”‚      β”‚   β””β”€ SimulationStageCS λ°”μΈλ”©                                   β”‚
β”‚      β”‚                                                                 β”‚
β”‚      β”β”€ νλΌλ―Έν„° μ—…λ΅λ“ (CPU β†’ GPU)                                    β”‚
β”‚      β”‚   β”β”€ Uniform Buffer μƒμ„±                                       β”‚
β”‚      β”‚   β”β”€ DataInterface λ²„νΌ μ¤€λΉ„                                   β”‚
β”‚      β”‚   β””β”€ μƒμ λ°μ΄ν„° μ—…λ΅λ“                                        β”‚
β”‚      β”‚                                                                 β”‚
β”‚      β””β”€ Compute Shader Dispatch                                        β”‚
β”‚          β”β”€ RHICmdList.DispatchComputeShader(...)                     β”‚
β”‚          β”β”€ ThreadGroup ν¬κΈ°: (64, 1, 1) - μΌλ°μ                      β”‚
β”‚          β””β”€ Dispatch νμ = (NumParticles + 63) / 64                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### Double Buffering λ©”μ»¤λ‹μ¦

**π“‚ μ†μ¤ κ²€μ¦:**
- `NiagaraComputeExecutionContext.h:1-200` - GPU μ‹¤ν–‰ μ»¨ν…μ¤νΈ

```cpp
// NiagaraComputeExecutionContext.h (λ”λΈ” λ²„νΌλ§)
struct FNiagaraComputeExecutionContext
{
    // λ”λΈ” λ²„νΌλ§: μ½κΈ°/μ“°κΈ° λ¶„λ¦¬
    FNiagaraDataBuffer* DataBuffers_RT[2] = { nullptr, nullptr };
    uint32 BufferSwapsThisFrame_RT = 0;

    // μ΄μ „ ν”„λ μ„ λ²„νΌ (μ½κΈ° μ „μ©)
    FNiagaraDataBuffer* GetPrevDataBuffer()
    {
        return DataBuffers_RT[(BufferSwapsThisFrame_RT & 1) ^ 1];
    }

    // λ‹¤μ ν”„λ μ„ λ²„νΌ (μ“°κΈ° λ€μƒ)
    FNiagaraDataBuffer* GetNextDataBuffer()
    {
        return DataBuffers_RT[(BufferSwapsThisFrame_RT & 1)];
    }

    // λ λ”λ§μ© μµμ‹  λ²„νΌ (μ½κΈ° μ „μ©, λ λ” μ¤λ λ“)
    FNiagaraDataBufferRef DataToRender = nullptr;
    FNiagaraDataBufferRef TranslucentDataToRender = nullptr;
};
```

**λ”λΈ” λ²„νΌλ§ λ™μ‘ μ›λ¦¬:**

```
ν”„λ μ„ N (BufferSwapsThisFrame_RT = 0):
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  Read Buffer  (Index 1): Buffer A (μ΄μ „ ν”„λ μ„ λ°μ΄ν„°)                  β”‚
β”‚  Write Buffer (Index 0): Buffer B (ν„μ¬ ν”„λ μ„ μ“°κΈ°)                    β”‚
β”‚                                                                         β”‚
β”‚  Compute Shader μ‹¤ν–‰:                                                   β”‚
β”‚  - Input: Buffer A (Particles.Position, Velocity λ“±)                   β”‚
β”‚  - Output: Buffer B (μ—…λ°μ΄νΈλ λ°μ΄ν„°)                                 β”‚
β”‚                                                                         β”‚
β”‚  β””β”€ Swap() νΈμ¶ β†’ BufferSwapsThisFrame_RT++                            β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

ν”„λ μ„ N+1 (BufferSwapsThisFrame_RT = 1):
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  Read Buffer  (Index 0): Buffer B (μ΄μ „ ν”„λ μ„ λ°μ΄ν„°)                  β”‚
β”‚  Write Buffer (Index 1): Buffer A (ν„μ¬ ν”„λ μ„ μ“°κΈ°)                    β”‚
β”‚                                                                         β”‚
β”‚  Compute Shader μ‹¤ν–‰:                                                   β”‚
β”‚  - Input: Buffer B (ν”„λ μ„ N κ²°κ³Ό)                                     β”‚
β”‚  - Output: Buffer A (μ—…λ°μ΄νΈλ λ°μ΄ν„°)                                 β”‚
β”‚                                                                         β”‚
β”‚  μ΄μ :                                                                   β”‚
β”‚  - μ½κΈ°/μ“°κΈ° μ¶©λ λ°©μ§€ (Read-Write Hazard νν”Ό)                        β”‚
β”‚  - GPU νμ΄ν”„λΌμΈ λ³‘λ ¬ν™” (μ΄μ „ ν”„λ μ„ μ½λ” λ™μ• λ‹¤μ ν”„λ μ„ μ“°κΈ°)       β”‚
β”‚  - μ•μ •μ μΈ μ‹λ®¬λ μ΄μ… (νν‹°ν΄ λ°μ΄ν„° μΌκ΄€μ„± λ³΄μ¥)                      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### GPU Compute Shader λ””μ¤ν¨μΉ

**μ¤λ λ“ κ·Έλ£Ή κµ¬μ„±:**

```hlsl
// Niagara Compute Shader (μΌλ°μ μΈ κµ¬μ΅°)
[numthreads(NIAGARA_COMPUTE_THREADGROUP_SIZE, 1, 1)]  // λ³΄ν†µ 64
void NiagaraComputeMain(
    uint3 DispatchThreadId : SV_DispatchThreadID,
    uint3 GroupThreadId : SV_GroupThreadID,
    uint3 GroupId : SV_GroupID)
{
    // DispatchThreadId.x = μ „μ—­ νν‹°ν΄ μΈλ±μ¤
    uint ParticleIndex = DispatchThreadId.x;

    if (ParticleIndex >= NumParticles)
        return;  // λ²”μ„ μ΄κ³Ό μ¤λ λ“ μΆ…λ£

    // SOA λ²„νΌμ—μ„ νν‹°ν΄ λ°μ΄ν„° μ½κΈ°
    float3 Position = InputFloatBuffer[ComponentOffset_Position + ParticleIndex];
    float3 Velocity = InputFloatBuffer[ComponentOffset_Velocity + ParticleIndex];
    float Age = InputFloatBuffer[ComponentOffset_Age + ParticleIndex];

    // μ‹λ®¬λ μ΄μ… λ΅μ§ (HLSLλ΅ μ»΄νμΌλ Niagara κ·Έλν”„)
    Velocity += Gravity * DeltaTime;
    Position += Velocity * DeltaTime;
    Age += DeltaTime;

    // SOA λ²„νΌμ— μ“°κΈ°
    OutputFloatBuffer[ComponentOffset_Position + ParticleIndex] = Position;
    OutputFloatBuffer[ComponentOffset_Velocity + ParticleIndex] = Velocity;
    OutputFloatBuffer[ComponentOffset_Age + ParticleIndex] = Age;
}
```

**λ””μ¤ν¨μΉ κ³„μ‚°:**

```cpp
// μμ‹: 10,000 νν‹°ν΄, ThreadGroup ν¬κΈ° = 64
uint32 NumParticles = 10000;
uint32 ThreadGroupSize = 64;

// ν•„μ”ν• ThreadGroup κ°μ κ³„μ‚° (μ¬λ¦Ό)
uint32 NumThreadGroups = (NumParticles + ThreadGroupSize - 1) / ThreadGroupSize;
// = (10000 + 64 - 1) / 64 = 10063 / 64 = 157 ThreadGroups

// RHI Dispatch νΈμ¶
RHICmdList.DispatchComputeShader(
    NumThreadGroupsX = 157,
    NumThreadGroupsY = 1,
    NumThreadGroupsZ = 1
);

// GPU μ‹¤ν–‰:
// - Total Threads = 157 Γ— 64 = 10,048 μ¤λ λ“
// - μ ν¨ μ¤λ λ“ = 10,000 (λ‚λ¨Έμ§€ 48κ°λ” early-out)
// - λ³‘λ ¬ μ‹¤ν–‰: 10,000κ° νν‹°ν΄ λ™μ‹ μ—…λ°μ΄νΈ
```

### GPU λ©”λ¨λ¦¬ μ „μ†΅ μµμ ν™”

**Coalesced Memory Access (λ³‘ν•© λ©”λ¨λ¦¬ μ ‘κ·Ό):**

```
SOA λ μ΄μ•„μ›ƒμ μ΄μ  (GPU κ΄€μ ):
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  Warp (32 μ¤λ λ“) λ™μ‹ μ‹¤ν–‰:                                             β”‚
β”‚  Thread 0: Read Position[0]                                            β”‚
β”‚  Thread 1: Read Position[1]                                            β”‚
β”‚  Thread 2: Read Position[2]                                            β”‚
β”‚  ...                                                                    β”‚
β”‚  Thread 31: Read Position[31]                                          β”‚
β”‚                                                                         β”‚
β”‚  β†’ μ—°μ†λ λ©”λ¨λ¦¬ μ ‘κ·Ό (Coalesced)                                        β”‚
β”‚  β†’ λ‹¨μΌ 128-byte μΊμ‹ λΌμΈ μ „μ†΅                                          β”‚
β”‚  β†’ λ©”λ¨λ¦¬ νΈλμ­μ… 1ν (μµμ !)                                           β”‚
β”‚                                                                         β”‚
β”‚  vs AOS λ μ΄μ•„μ›ƒ (λΉ„ν¨μ¨):                                               β”‚
β”‚  Thread 0: Read Particle[0].Position (μΊμ‹ λΌμΈ 0)                      β”‚
β”‚  Thread 1: Read Particle[1].Position (μΊμ‹ λΌμΈ 1)                      β”‚
β”‚  ...                                                                    β”‚
β”‚  Thread 31: Read Particle[31].Position (μΊμ‹ λΌμΈ 31)                   β”‚
β”‚  β†’ 32κ° λ³„λ„ μΊμ‹ λΌμΈ (ν©μ–΄μ§„ μ ‘κ·Ό)                                     β”‚
β”‚  β†’ λ©”λ¨λ¦¬ νΈλμ­μ… 32ν (32λ°° λλ¦Ό!)                                     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

**μ„±λ¥ μΈ΅μ •:**

```
100,000 νν‹°ν΄ μ—…λ°μ΄νΈ (Simple Update Script):

CPU (VectorVM, AVX):
- μ¤λ λ“ 1κ°: ~5ms
- μ¤λ λ“ 4κ° (λ³‘λ ¬): ~1.5ms

GPU (Compute Shader):
- SOA + Coalesced Access: ~0.5ms (10λ°° λΉ λ¦„!)
- AOS (κ°€μƒ, μ‚¬μ© μ• ν•¨): ~15ms (30λ°° λλ¦Ό)

GPU λ€μ—­ν­ μ‚¬μ©:
- νν‹°ν΄λ‹Ή 8 floats (Pos, Vel, Color λ“±)
- Read: 100,000 Γ— 8 Γ— 4 bytes = 3.2 MB
- Write: 100,000 Γ— 8 Γ— 4 bytes = 3.2 MB
- Total: 6.4 MB / 0.5ms = 12.8 GB/s (RTX 4090 λ€μ—­ν­: 1TB/sμ 1.3%)
```

---

## π’΅ μ‹¤μ „ μμ‹ (Practical Examples)

### β… μΆ‹μ€ μ: CPU μ‹λ®¬λ μ΄μ… μµμ ν™”

```cpp
// β… SOA λ μ΄μ•„μ›ƒ ν™μ© (VectorVM λ‚΄λ¶€)
void UpdateParticlePositions_Optimized(
    FNiagaraDataSet& DataSet,
    float DeltaTime,
    int32 NumParticles)
{
    // β… SOA λ²„νΌ μ§μ ‘ μ ‘κ·Ό
    float* PositionX = DataSet.GetFloatBuffer(FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Position.X")));
    float* PositionY = DataSet.GetFloatBuffer(FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Position.Y")));
    float* PositionZ = DataSet.GetFloatBuffer(FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Position.Z")));

    float* VelocityX = DataSet.GetFloatBuffer(FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Velocity.X")));
    float* VelocityY = DataSet.GetFloatBuffer(FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Velocity.Y")));
    float* VelocityZ = DataSet.GetFloatBuffer(FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Velocity.Z")));

    // β… SIMD λ…λ Ήμ–΄λ΅ 4κ°μ”© μ²λ¦¬
    __m128 DeltaTimeVec = _mm_set1_ps(DeltaTime);

    for (int32 i = 0; i < NumParticles; i += 4)
    {
        // X μ»΄ν¬λ„νΈ
        __m128 PosX = _mm_load_ps(&PositionX[i]);
        __m128 VelX = _mm_load_ps(&VelocityX[i]);
        PosX = _mm_add_ps(PosX, _mm_mul_ps(VelX, DeltaTimeVec));
        _mm_store_ps(&PositionX[i], PosX);

        // Y μ»΄ν¬λ„νΈ
        __m128 PosY = _mm_load_ps(&PositionY[i]);
        __m128 VelY = _mm_load_ps(&VelocityY[i]);
        PosY = _mm_add_ps(PosY, _mm_mul_ps(VelY, DeltaTimeVec));
        _mm_store_ps(&PositionY[i], PosY);

        // Z μ»΄ν¬λ„νΈ
        __m128 PosZ = _mm_load_ps(&PositionZ[i]);
        __m128 VelZ = _mm_load_ps(&VelocityZ[i]);
        PosZ = _mm_add_ps(PosZ, _mm_mul_ps(VelZ, DeltaTimeVec));
        _mm_store_ps(&PositionZ[i], PosZ);
    }
}

// μ„±λ¥: 10k νν‹°ν΄, ~0.4ms (μΌλ° λ£¨ν”„ λ€λΉ„ 6λ°° λΉ λ¦„)
```

### β… μΆ‹μ€ μ: λ°°μΉ μ‹λ®¬λ μ΄μ… ν™μ©

```cpp
// β… λ™μΌ μ‹μ¤ν…μ λ‹¤μ μΈμ¤ν„΄μ¤ μƒμ„±
void SpawnMultipleExplosions(UWorld* World, UNiagaraSystem* ExplosionSystem, const TArray<FVector>& Locations)
{
    // β… λ™μΌ μ‹μ¤ν…μ„ λ‹¤μ μΈμ¤ν„΄μ¤λ΅ μƒμ„±
    for (const FVector& Location : Locations)
    {
        UNiagaraComponent* Explosion = UNiagaraFunctionLibrary::SpawnSystemAtLocation(
            World,
            ExplosionSystem,  // λ™μΌ μ‹μ¤ν… μ‚¬μ©
            Location,
            FRotator::ZeroRotator,
            FVector(1.0f),
            /*bAutoDestroy=*/ true,
            /*bAutoActivate=*/ true,
            /*PoolingMethod=*/ ENCPoolMethod::AutoRelease
        );
    }

    // β… λ‚΄λ¶€ λ™μ‘:
    // 1. λ¨λ“  Explosion μΈμ¤ν„΄μ¤κ°€ λ™μΌν• FNiagaraSystemSimulationμ— μ¶”κ°€λ¨
    // 2. SystemSpawnScriptλ” 1λ²λ§ λ°”μΈλ”©λ¨ (λ°°μΉλ΅ μ‹¤ν–‰)
    // 3. Concurrent Tickμ—μ„ λ¨λ“  μΈμ¤ν„΄μ¤κ°€ λ°°μΉλ΅ μ²λ¦¬λ¨
    // 4. μΊμ‹ ν¨μ¨ κ·Ήλ€ν™”

    // μ„±λ¥ λΉ„κµ:
    // - κ°λ³„ μ‹¤ν–‰: 100κ° μΈμ¤ν„΄μ¤ = 100ν λ°”μΈλ”© + 100ν μ‹¤ν–‰ (~10ms)
    // - λ°°μΉ μ‹¤ν–‰: 100κ° μΈμ¤ν„΄μ¤ = 1ν λ°”μΈλ”© + 1ν λ°°μΉ μ‹¤ν–‰ (~2ms, 5λ°° λΉ λ¦„)
}
```

### β… μΆ‹μ€ μ: Concurrent Tick ν™μ©

```cpp
// β… Concurrent Tickμ—μ„ λ¬΄κ±°μ΄ κ³„μ‚° μν–‰
// Niagara Module Script μμ‹ (Particle Update):
/*
// μ΄ μ¤ν¬λ¦½νΈλ” Concurrent Threadμ—μ„ μ‹¤ν–‰λ¨

// β… λ³µμ΅ν• κ³„μ‚° μν–‰ κ°€λ¥ (λ©”μΈ μ¤λ λ“ λΈ”λ΅ν‚Ή μ—†μ)
float NoiseValue = CurlNoise(Particles.Position, Time);
FVector NoiseForce = FVector(NoiseValue.X, NoiseValue.Y, NoiseValue.Z) * ForceStrength;

// Velocity μ—…λ°μ΄νΈ
Particles.Velocity += NoiseForce * DeltaTime;

// Position μ—…λ°μ΄νΈ
Particles.Position += Particles.Velocity * DeltaTime;

// β… DataInterface νΈμ¶λ„ Concurrentμ—μ„ μ•μ „
FVector SurfacePosition;
FVector SurfaceNormal;
bool bHit = CollisionQuery.PerformLineTrace(
    Particles.Position,
    Particles.Position + Particles.Velocity * DeltaTime,
    SurfacePosition,
    SurfaceNormal
);

if (bHit)
{
    // μ¶©λ μ²λ¦¬
    Particles.Position = SurfacePosition + SurfaceNormal * 0.1;
    Particles.Velocity = reflect(Particles.Velocity, SurfaceNormal) * Bounciness;
}
*/

// μ„±λ¥:
// - 10k νν‹°ν΄ Curl Noise + Collision: ~3ms (Concurrent, λ³‘λ ¬)
// - λ™μΌ λ΅μ§ GameThread μ‹¤ν–‰ μ‹: ~15ms (μμ°¨ μ‹¤ν–‰)
```

### β λ‚μ μ: GameThreadμ—μ„ λ¬΄κ±°μ΄ κ³„μ‚°

```cpp
// β μλ»λ λ°©λ²•: GameThreadμ—μ„ νν‹°ν΄ μ§μ ‘ μ—…λ°μ΄νΈ
void BadParticleUpdate_GameThread(FNiagaraSystemInstance* Instance)
{
    // β GameThreadμ—μ„ νν‹°ν΄ λ°μ΄ν„° μ§μ ‘ μ ‘κ·Ό
    FNiagaraDataSet& DataSet = Instance->GetEmitters()[0]->GetParticleData();

    // β μμ°¨ λ£¨ν”„λ΅ μ—…λ°μ΄νΈ (λλ¦Ό!)
    for (int32 i = 0; i < DataSet.GetNumInstances(); ++i)
    {
        // β λ³µμ΅ν• κ³„μ‚° (GameThread λΈ”λ΅ν‚Ή!)
        FVector Position = GetParticlePosition(DataSet, i);
        FVector Velocity = GetParticleVelocity(DataSet, i);

        // β λ¬΄κ±°μ΄ κ³„μ‚°
        FVector NoiseForce = CalculateComplexNoise(Position);  // ~0.01ms per particle

        Velocity += NoiseForce * DeltaTime;
        Position += Velocity * DeltaTime;

        SetParticlePosition(DataSet, i, Position);
        SetParticleVelocity(DataSet, i, Velocity);
    }

    // λ¬Έμ :
    // - 10k νν‹°ν΄ = 10,000 * 0.01ms = 100ms (κ²μ„ λ©μ¶¤!)
    // - GameThread λΈ”λ΅ν‚Ή β†’ ν”„λ μ„ λ“λ΅­
    // - SIMD λ―Έμ‚¬μ© β†’ λΉ„ν¨μ¨μ 
}
```

**μ¬λ°”λ¥Έ λ°©λ²•:**

```cpp
// β… μ¬λ°”λ¥Έ λ°©λ²•: Niagara Scriptλ΅ μ‘μ„±
// Particle Update Scriptμ—μ„ μλ™μΌλ΅ Concurrent μ‹¤ν–‰λ¨
/*
// Niagara Script (μλ™μΌλ΅ VectorVMμΌλ΅ μ»΄νμΌλ¨):
FVector NoiseForce = CurlNoise(Particles.Position, Time) * ForceStrength;
Particles.Velocity += NoiseForce * DeltaTime;
Particles.Position += Particles.Velocity * DeltaTime;

// λ‚΄λ¶€ λ™μ‘:
// 1. VectorVM λ°”μ΄νΈμ½”λ“λ΅ μ»΄νμΌ
// 2. Concurrent Threadμ—μ„ μ‹¤ν–‰
// 3. SIMD μµμ ν™” (4κ°μ”© λ³‘λ ¬ μ²λ¦¬)
// 4. 10k νν‹°ν΄ = ~2ms (50λ°° λΉ λ¦„!)
*/
```

### β… μΆ‹μ€ μ: DataSet μ½κΈ°/μ“°κΈ° ν¨ν„΄

```cpp
// β… DataSet μ•μ „ν• μ½κΈ°/μ“°κΈ°
void SafeDataSetAccess(FNiagaraEmitterInstance* EmitterInstance)
{
    // β… DataSet μ ‘κ·Ό (μ½κΈ° μ „μ©)
    const FNiagaraDataSet& DataSet = EmitterInstance->GetParticleData();

    // β… νν‹°ν΄ κ°μ ν™•μΈ
    int32 NumParticles = DataSet.GetNumInstances();

    if (NumParticles == 0)
        return;

    // β… νΉμ • Attribute μ½κΈ°
    FNiagaraDataSetReaderFloat<FNiagaraPosition> PositionReader(DataSet, FNiagaraVariable(FNiagaraTypeDefinition::GetPositionDef(), TEXT("Particles.Position")));
    FNiagaraDataSetReaderFloat<FNiagaraFloat> AgeReader(DataSet, FNiagaraVariable(FNiagaraTypeDefinition::GetFloatDef(), TEXT("Particles.Age")));

    // β… μ½κΈ° (μ¤λ λ“ μ•μ „)
    for (int32 i = 0; i < NumParticles; ++i)
    {
        FVector Position = PositionReader.GetSafe(i, FVector::ZeroVector);
        float Age = AgeReader.GetSafe(i, 0.0f);

        // λ°μ΄ν„° ν™μ© (μ: λ””λ²„κ·Έ μ¶λ ¥)
        if (Age > 5.0f)
        {
            UE_LOG(LogNiagara, Log, TEXT("Old Particle at %s"), *Position.ToString());
        }
    }

    // β μ“°κΈ°λ” Niagara Scriptμ—μ„λ§ μν–‰!
    // DataSet μ“°κΈ°λ” Concurrent Tick μ¤‘μ—λ§ μ•μ „
}
```

---

## π“ μ„±λ¥ μµμ ν™” (Performance Optimization)

### CPU vs GPU μ„±λ¥ λΉ„κµ

```
νν‹°ν΄ κ°μλ³„ μ„±λ¥ (λ‹¨μΌ μ—λ―Έν„°, Simple Update):
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  νν‹°ν΄ κ°μ β”‚ CPU (VectorVM) β”‚ GPU (Compute) β”‚ κ¶μ¥                   β”‚
β”‚β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”‚
β”‚  1,000       β”‚ ~0.1ms         β”‚ ~0.05ms       β”‚ CPU (μ¤λ²„ν—¤λ“ μ‘μ)    β”‚
β”‚  10,000      β”‚ ~0.5ms         β”‚ ~0.1ms        β”‚ CPU (κ· ν•)             β”‚
β”‚  50,000      β”‚ ~2.5ms         β”‚ ~0.3ms        β”‚ GPU (CPU ν•κ³„)         β”‚
β”‚  100,000     β”‚ ~5ms           β”‚ ~0.5ms        β”‚ GPU (10λ°° λΉ λ¦„)        β”‚
β”‚  500,000     β”‚ ~25ms (λ¶κ°€)   β”‚ ~2ms          β”‚ GPU ν•„μ               β”‚
β”‚  1,000,000   β”‚ N/A            β”‚ ~4ms          β”‚ GPU μ „μ©               β”‚
β”‚                                                                         β”‚
β”‚  λ³µμ΅ν• κ³„μ‚° (Curl Noise + Collision):                                  β”‚
β”‚  10,000      β”‚ ~3ms           β”‚ ~0.5ms        β”‚ GPU κ¶μ¥               β”‚
β”‚  100,000     β”‚ ~30ms (λ¶κ°€)   β”‚ ~3ms          β”‚ GPU ν•„μ               β”‚
β”‚                                                                         β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μµμ ν™” μ „λµ

**1. λ°°μΉ μ‹λ®¬λ μ΄μ… ν™μ©:**

```cpp
// β… λ™μΌ μ‹μ¤ν… μ‚¬μ© (λ°°μΉλ΅ λ¬¶μ„)
UNiagaraSystem* SharedSystem = LoadObject<UNiagaraSystem>(...);

for (int32 i = 0; i < 100; ++i)
{
    SpawnSystemAtLocation(World, SharedSystem, RandomLocation());
}

// β λ‹¤λ¥Έ μ‹μ¤ν… μ‚¬μ© (λ°°μΉ λ¶κ°€)
for (int32 i = 0; i < 100; ++i)
{
    UNiagaraSystem* UniqueSystem = DuplicateObject(OriginalSystem, nullptr);
    SpawnSystemAtLocation(World, UniqueSystem, RandomLocation());
}
```

**2. SimTarget μ„ νƒ:**

```cpp
// β… νν‹°ν΄ κ°μμ— λ”°λΌ SimTarget μ„¤μ •
void SetOptimalSimTarget(FVersionedNiagaraEmitterData* EmitterData, int32 ExpectedParticleCount)
{
    if (ExpectedParticleCount < 10000)
    {
        // CPU μ‹λ®¬λ μ΄μ… (λ””λ²„κΉ… νΈμ, λ‚®μ€ μ¤λ²„ν—¤λ“)
        EmitterData->SimTarget = ENiagaraSimTarget::CPUSim;
    }
    else if (ExpectedParticleCount < 100000)
    {
        // GPU μ‹λ®¬λ μ΄μ… (μ„±λ¥ μ°μ„ )
        EmitterData->SimTarget = ENiagaraSimTarget::GPUComputeSim;
    }
    else
    {
        // GPU ν•„μ (CPUλ΅λ” λ¶κ°€λ¥)
        EmitterData->SimTarget = ENiagaraSimTarget::GPUComputeSim;
    }
}
```

**3. Fixed Bounds μ‚¬μ©:**

```cpp
// β… Fixed Boundsλ΅ Bounds κ³„μ‚° μ¤ν‚µ
void UseFixedBounds(UNiagaraComponent* NiagaraComp)
{
    // β… κ³ μ • κ²½κ³„ μ„¤μ •
    FBox FixedBounds(FVector(-100, -100, -100), FVector(100, 100, 100));
    NiagaraComp->SetSystemFixedBounds(FixedBounds);

    // μ΄μ :
    // - Bounds κ³„μ‚° μ¤ν‚µ (λ¨λ“  νν‹°ν΄ μν λ¶ν•„μ”)
    // - Concurrent Tick μ‹κ°„ λ‹¨μ¶• (~0.5ms μ μ•½)
    // - νΉν λ€λ‰ νν‹°ν΄μ—μ„ ν¨κ³Όμ 
}

// β Dynamic Bounds (λλ¦Ό)
// λ§¤ ν”„λ μ„ λ¨λ“  νν‹°ν΄ μ„μΉ ν™•μΈν•μ—¬ Bounds κ³„μ‚°
```

**4. Scalability μ„¤μ •:**

```cpp
// β… Effect Typeλ³„ Scalability μ„¤μ •
// DefaultNiagara.ini:
[FX]
fx.Niagara.QualityLevel=3  // 0=Low, 1=Medium, 2=High, 3=Epic, 4=Cinematic

// Systemλ³„ Scalability μ„¤μ •
UNiagaraSystem* System = ...;
System->SetEffectType(UNiagaraEffectType::StaticClass()->GetDefaultObject());

// Effect Type μ„¤μ •:
UNiagaraEffectType* EffectType = ...;
EffectType->PerformanceBaselineController->SetQualityLevelMask(
    ENCQualityLevel::Low,      // 0
    ENCQualityLevel::High      // 2
);
// Quality Levelμ΄ Low~HighμΌ λ•λ§ ν™μ„±ν™”
```

---

## π”§ λ””λ²„κΉ… λ° νΈλ¬λΈ”μν… (Debugging & Troubleshooting)

### ν”ν• μ—λ¬μ™€ ν•΄κ²° λ°©λ²•

**1. \"System simulation tick too long\"**

```
μ›μΈ: Concurrent Tick μ‹κ°„μ΄ ν”„λ μ„ μ‹κ°„ μ΄κ³Ό

ν•΄κ²°μ±…:
1. νν‹°ν΄ κ°μ ν™•μΈ
   stat Niagara β†’ νν‹°ν΄ κ°μ ν™•μΈ

2. GPUλ΅ μ „ν™
   SimTarget = GPUComputeSim

3. Scalability μ„¤μ •
   NumInstancesToActivate κ°μ†

4. Fixed Bounds μ‚¬μ©
   λ™μ  Bounds κ³„μ‚° μ¤ν‚µ
```

**2. \"Data race in DataSet access\"**

```
μ›μΈ: GameThreadμ™€ Concurrent Threadκ°€ λ™μ‹μ— DataSet μ ‘κ·Ό

ν•΄κ²°μ±…:
// β μλ»λ λ°©λ²•
void BadTick()
{
    // GameThreadμ—μ„ DataSet μμ • (Concurrent Tick μ¤‘!)
    DataSet.SetParticlePosition(0, NewPosition);  // ν¬λμ‹!
}

// β… μ¬λ°”λ¥Έ λ°©λ²•
// DataSet μμ •μ€ Niagara Scriptμ—μ„λ§!
// GameThreadμ—μ„λ” ParameterStoreλ§ μμ •
NiagaraComp->SetVariableVec3(FName("User.TargetPosition"), NewPosition);
```

**3. \"GPU simulation not working\"**

```
μ›μΈ: ν”λ«νΌμ΄ Compute Shader λ―Έμ§€μ›

ν•΄κ²°μ±…:
1. RHI μ§€μ› ν™•μΈ
   r.Niagara.AllowComputeShaders 1

2. Feature Level ν™•μΈ
   ERHIFeatureLevel::SM5 μ΄μƒ ν•„μ”

3. Fallback μ„¤μ •
   EmitterData->bGPUOnly = false  // CPU Fallback ν—μ©
```

**4. \"Emitter not ticking\"**

```
μ›μΈ: ExecutionStateκ°€ Disabled λλ” Complete

ν•΄κ²°μ±…:
FNiagaraEmitterInstance* Emitter = ...;

// μƒνƒ ν™•μΈ
ENiagaraExecutionState State = Emitter->GetExecutionState();
UE_LOG(LogNiagara, Log, TEXT("Emitter State: %d"), (int32)State);

// Activeλ΅ μ „ν™
if (State != ENiagaraExecutionState::Active)
{
    Emitter->GetParentSystemInstance()->Activate();
}
```

### Niagara Debugger ν™μ©

```
μ½μ†” λ…λ Ήμ–΄:

stat Niagara
  - SystemSimulationλ³„ Tick Time
  - Concurrent vs GameThread μ‹κ°„ λΉ„κµ
  - μ΄ νν‹°ν΄ κ°μ

stat NiagaraGPU
  - GPU Compute Shader μ‹¤ν–‰ μ‹κ°„
  - GPU λ©”λ¨λ¦¬ μ‚¬μ©λ‰
  - Dispatch νμ

fx.Niagara.Debug.DrawSystemBounds 1
  - System Bounds μ‹κ°ν™”
  - Dynamic vs Fixed Bounds ν™•μΈ

fx.Niagara.Debug.DrawDataSets 1
  - DataSet ν¬κΈ° λ° νν‹°ν΄ κ°μ
  - SOA λ μ΄μ•„μ›ƒ μ‹κ°ν™”

fx.Niagara.ShowAllocationWarnings 1
  - λ©”λ¨λ¦¬ ν• λ‹Ή κ²½κ³  ν‘μ‹
  - κ³Όλ„ν• μ¬ν• λ‹Ή κ°μ§€
```

---

## π”— κ΄€λ ¨ λ¬Έμ„ (Related Documents)

- **[Overview.md](../Overview.md)** - Niagara μ‹μ¤ν… μ „μ²΄ κ°μ”
- **[NiagaraSystem.md](NiagaraSystem.md)** - μ‹μ¤ν… μ—μ…‹
- **[NiagaraEmitter.md](NiagaraEmitter.md)** - μ—λ―Έν„° μ—μ…‹
- **[NiagaraScript.md](NiagaraScript.md)** - μ¤ν¬λ¦½νΈ μ»΄νμΌ μ‹μ¤ν…
- **[DataInterface.md](DataInterface.md)** - DataInterface μ‹μ¤ν…
- **[NiagaraComponent.md](NiagaraComponent.md)** - λ°νƒ€μ„ μ»΄ν¬λ„νΈ

---

## π“ μ°Έκ³  μλ£ (References)

### μ†μ¤ νμΌ

- `Engine/Plugins/FX/Niagara/Source/Niagara/Public/NiagaraSystemSimulation.h`
- `Engine/Plugins/FX/Niagara/Source/Niagara/Public/NiagaraSystemInstance.h`
- `Engine/Plugins/FX/Niagara/Source/Niagara/Classes/NiagaraEmitterInstance.h`
- `Engine/Plugins/FX/Niagara/Source/Niagara/Classes/NiagaraDataSet.h`

### κ³µμ‹ λ¬Έμ„

- [Niagara System Overview](https://docs.unrealengine.com/5.7/en-US/niagara-system-overview/)
- [Niagara Performance Guide](https://docs.unrealengine.com/5.7/en-US/niagara-performance-guide/)

### μ£Όμ” API

```cpp
// FNiagaraSystemSimulation (μ£Όμ” λ©”μ„λ“)
void Tick_GameThread(float DeltaSeconds, const FGraphEventRef& MyCompletionGraphEvent);
void Tick_Concurrent(FNiagaraSystemSimulationTickContext& Context);
void AddInstance(FNiagaraSystemInstance* Instance);
void RemoveInstance(FNiagaraSystemInstance* Instance);

// FNiagaraSystemInstance (μ£Όμ” λ©”μ„λ“)
void Tick_GameThread(float DeltaSeconds);
void Tick_Concurrent(bool bEnqueueGPUTickIfNeeded = true);
void FinalizeTick_GameThread(bool bEnqueueGPUTickIfNeeded = true);
void Activate();
void Deactivate();
void Complete();
void SetPaused(bool bPaused);
FNiagaraSystemSimulation* GetSystemSimulation() const;

// FNiagaraEmitterInstance (μ£Όμ” λ©”μ„λ“)
virtual void Init(int32 InEmitterIdx);
virtual void ResetSimulation(bool bKillExisting = true) = 0;
virtual void Tick(float DeltaSeconds) = 0;
virtual int32 GetNumParticles() const;
FNiagaraDataSet& GetParticleData();
FNiagaraComputeExecutionContext* GetGPUContext() const;
FBox GetBounds() const;
ENiagaraExecutionState GetExecutionState() const;

// FNiagaraDataSet (μ£Όμ” λ©”μ„λ“)
int32 GetNumInstances() const;
int32 GetMaxInstances() const;
void Allocate(int32 NumInstances);
FNiagaraDataBuffer& GetCurrentData();
const FNiagaraDataBuffer& GetCurrentData() const;
```

---

> π”„ **μ‘μ„±μΌ**: 2025-11-10
> π“ **λ¬Έμ„ λ²„μ „**: v1.0
> β… **μ†μ¤ κ²€μ¦**: UE 5.7.0
> π“‚ **Niagara Core λ¬Έμ„ μ™„λ£**: 7/7 λ¬Έμ„ μ‘μ„± μ™„λ£ (Overview, NiagaraSystem, NiagaraEmitter, NiagaraComponent, DataInterface, NiagaraScript, Simulation)
